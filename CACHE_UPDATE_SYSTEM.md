# ???? ??????? ???????? ?????

## ?? ?????
???? ?????? ?????? ??????? ??????? ???????? ???????? ????? ??? ?????????? ???? ?????? ???? ????? ??????.

## ?? ????????
- ? ??? ???? ?????? ????????? (?? 5 ?????)
- ? ??? ???? ??? ???? ???????? ???????
- ? ??? ????? ???????? ??? ?????? ????? ????
- ? ??????? ???? ????????
- ? ?????? ??? ???????? ?????? (tokens, preferences)
- ? ??? Force Update ????????? ??????

## ?? ???????

### 1. `version.json`
??? JSON ????? ??? ??????? ??????? ??????:
```json
{
  "version": "1.0.0",
  "buildDate": "2024-01-01T00:00:00Z",
  "forceUpdate": false
}
```

### 2. `js/version-manager.js`
???????? ??????? ?????? ?????????:
- ??? ????????? ??????
- ??? ????? ??? ?????? ????? ????
- ????? ????????? ?????? ???????

### 3. `service-worker.js`
Service Worker ????? ?????? ?????:
- ??????????? ??? ????
- ??? ????? ?????? ????????
- ??? ????? Offline

### 4. `update-version.ps1`
?????? PowerShell ?????? ??? ???????:
```powershell
# ????? patch (1.0.0 ? 1.0.1)
.\update-version.ps1

# ????? minor (1.0.0 ? 1.1.0)
.\update-version.ps1 -VersionType minor

# ????? major (1.0.0 ? 2.0.0)
.\update-version.ps1 -VersionType major

# ????? ?? ??? ??????? ??????
.\update-version.ps1 -ForceUpdate $true
```

## ?? ????? ?????????

### ??? ????? ???? ?????:

1. **?? ?????? ????????? ????????**

2. **?? ?????? ??? ???????:**
   ```powershell
   # ????????? ??????? (bug fixes)
   .\update-version.ps1
   
   # ??????? ???????
   .\update-version.ps1 -VersionType minor
   
   # ????????? ??????? (breaking changes)
   .\update-version.ps1 -VersionType major
   ```

3. **???? ??????? (Deploy)**

4. **??????? ???? ???????? ??? ??????????:**
   - ??? ??????? ??????? (???? 5 ?????)
   - ??? ?????? ??????? ??? ????
   - ?????? ??? ??? `forceUpdate: true`

## ?? ?????????

### ????? ???? ????? ???????:
?? ??? `version-manager.js`:
```javascript
const VERSION_CHECK_INTERVAL = 300000; // 5 ????? ??????? ?????
```

### ???????? ???????? (?? ??? ?????):
```javascript
const keysToKeep = [
    'auth_token',
    'refresh_token',
    'user_preferences',
    'selected_language'
];
```

## ?? ??? ????? ????????

```
1. ???????? ???? ???????
   ?
2. Version Manager ???? version.json
   ?
3. ?????? ??????? ?????? ?? ????? ???????
   ?
4. ??? ??? ???? ?????:
   ?? ??? ???? ?????
   ?? ????? ????? Service Workers
   ?? ??? SessionStorage
   ?? ?????? ??? ???????? ??????
   ?? ??? ??????? ??????
   ?? ????? ????? ????????
   ?? ????? ????? ??????? (Hard Reload)
```

## ?? ????? ?????????

?????? ???? ????? ?? ?????????:

### 1. SweetAlert (??? ??? ?????):
```javascript
swal({
    title: '????? ??????',
    text: '????? ????? ????...',
    icon: 'info'
});
```

### 2. ????? ???? (Fallback):
????? ???? ???? ?? CSS ???? ????????

## ?? ?????? ?????????

????? ?????? ????? ??????? ?? Console:
```
?? Version Manager: Initializing...
?? Current Version: 1.0.0
?? Server Version: 1.0.1
?? New version detected! Updating...
?? Clearing cache...
??? Deleting cache: dashboard-cache-v1.0.0
? Storage cleaned (keeping essential data)
?? ????? ????? ???? (1.0.1)...
?? Reloading application...
```

## ??? ??? ?? CI/CD

### GitHub Actions:
```yaml
- name: Update Version
  run: |
    .\update-version.ps1 -VersionType patch
    
- name: Commit Version
  run: |
    git config user.name "GitHub Actions"
    git config user.email "actions@github.com"
    git add src/Presentation/Dashboard/wwwroot/version.json
    git add src/Presentation/Dashboard/wwwroot/service-worker.js
    git commit -m "chore: bump version [skip ci]"
    git push
```

### Azure DevOps:
```yaml
- task: PowerShell@2
  inputs:
    targetType: 'filePath'
    filePath: '$(Build.SourcesDirectory)/update-version.ps1'
    arguments: '-VersionType patch'
```

## ?? ?????? ??????

### ?????? ????:
1. ???? ??????? ?? ???????
2. ???? Console (F12)
3. ?? ?????? `version.json` ??????
4. ????? 5 ????? ?? ?? ?????? ????? ??????
5. ??? ?? ??? ????? ???????

### ??? ???? ?? Console:
```javascript
// ??? ??????? ??????
localStorage.getItem('app_version')

// ??? ???? ?????????
VersionManager.manualCheck()

// ??? ????? ??????
caches.keys().then(names => 
    Promise.all(names.map(name => caches.delete(name)))
)
```

## ?? ??????? ???????

### ???????: ??????? ?? ????
? **??????:**
- ???? ?? ???? `version-manager.js` ?? ?????? ??????
- ???? ?? ?? `version.json` ???? ??????
- ???? ?? Console ???????
- ???? ?? ??? ???? ????? ?????????

### ???????: ????? ?? ?????
? **??????:**
- ???? ?? ?? Service Worker ???? ???? ????
- ???? Unregister Service Worker ??????
- ???? ????? ?????? ?? DevTools

## ?? ??????? ????

1. **??????? ?????:** ??? ??? ?????? ??? ??? ??????? ?????? ??? (?? ??? ???????)
2. **???????? ????????:** Tokens ???? Preferences ???? ?????? ??? ???????
3. **????? ??????:** ??? ?? 5 ????? + ??? ???? ???????? ???????
4. **Force Update:** ???? ??????? ?????? ???? ?????

## ?? Best Practices

1. **?????? Semantic Versioning:**
   - `major.minor.patch`
   - `1.0.0` ? `1.0.1` (patch)
   - `1.0.0` ? `1.1.0` (minor)
   - `1.0.0` ? `2.0.0` (major)

2. **Force Update ????????? ?????? ???:**
   - Security patches
   - Breaking changes
   - Critical bug fixes

3. **????? ??? ?????:**
   - ????? ??????? ??? ???? Staging ?????
   - ???? ?? ??? ????? ???? ????
   - ???? Console ?????? ?? ??? ???? ?????

## ?? ?????

??? ????? ?? ?????:
1. ???? Console ???????
2. ???? ?? Network Tab
3. ???? ?? ??? `version.json`
4. ???? ??? ????? ??????

---

**?? ??????? ??????:** ???? ???????  
**??? ?????:** 2024  
**???????:** 1.0.0
