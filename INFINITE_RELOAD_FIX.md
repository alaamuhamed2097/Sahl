# ?? ?? ????? Infinite Reload

## ???????:
??????? ???? reload ??? ????? ????? toast ??????? ??????? ??

---

## ?? ?????:

### 1. `forceUpdate: true` ?? version.json
????? ???? `forceUpdate: true`? ??????? ???? reload ???? ?? ?? ??? ????.

### 2. ?????? ?????????
??????? ??? ?????? ?? UTF-8 encoding.

---

## ? ???? ?????? (30 ?????):

### ?????? 1: ???? ??? Cache
???? Console ?? ??????? (F12) ????? ??? ?????:

```javascript
// ??? ????? ?? Console
localStorage.clear();
sessionStorage.clear();
caches.keys().then(k => Promise.all(k.map(c => caches.delete(c))));
navigator.serviceWorker.getRegistrations().then(r => r.forEach(x => x.unregister()));
setTimeout(() => location.reload(true), 2000);
```

???? Enter ?????? 2 ?????.

---

### ?????? 2: ???? ?? version.json
????: `src/Presentation/Dashboard/wwwroot/version.json`

??? ?? ????:
```json
{
  "version": "1.0.1",
  "buildDate": "2025-01-15T10:00:00Z",
  "forceUpdate": false  ? ??? ?? ???? false
}
```

??? ??? `"forceUpdate": true`? ????? ?? `false`.

---

### ?????? 3: ??? ????? ???????

```powershell
# ?? VS Code Terminal
cd src\Presentation\Dashboard
dotnet run
```

---

## ??? ???? ?????? (5 ?????):

### 1. ???? ???????:
? `version-manager.js` - ????? encoding ????? ????? ?? infinite loop
? `version.json` - ????? `forceUpdate` ?? `false`

### 2. ???? ??? localStorage:

#### ??????? 1: ?? Console
```javascript
localStorage.clear();
sessionStorage.clear();
location.reload(true);
```

#### ??????? 2: ?? Application Tab
1. ???? DevTools (F12)
2. ???? ?? **Application** tab
3. Local Storage ? ???? Clear all
4. Session Storage ? ???? Clear all
5. Service Workers ? ???? Unregister ??? ????
6. Reload

#### ??????? 3: ?????? ???????? ??????
???? Console ?????:
```javascript
// ?? ?????? ???????? ??????
fetch('/js/emergency-reset.js')
  .then(r => r.text())
  .then(code => eval(code));
```

---

## ?? ??? ?????? Force Update?

### ? ?????? Force Update ??:
- Security fixes ????
- Critical bugs
- Breaking changes
- Database migrations

### ? ?? ??????? ??:
- Bug fixes ?????
- Features ?????
- UI improvements

---

## ?? ????????? ??????:

### ????????? ???????:
```powershell
# Patch (bug fix)
.\quick-update.bat
# ???? 1

# Minor (feature)
.\quick-update.bat
# ???? 2
```

### ????????? ??????? ???:
```powershell
# Major with Force (breaking change)
.\update-version.ps1 -Type major -ForceUpdate

# ??
.\quick-update.bat
# ???? 4 (Force Update)
```

**?? ??????:** ??? ??? Force Update? **???** ????? `forceUpdate` ?? `false` ?? ??????? ??????!

---

## ?? ??? ????? ??????:

```powershell
# 1. ????? ????
.\quick-update.bat  # ???? 1 ?? 2
dotnet run
# ? forceUpdate: false

# 2. ???
dotnet publish -c Release
# ??? ???????

# 3. ??? ????? Force Update (????!)
.\update-version.ps1 -Type patch -ForceUpdate
dotnet publish -c Release
# ??? ???????
# ?? ?????????? ?????? ????? ????????? ?????!

# 4. ?? ??????? ??????? ???? ?? normal
.\quick-update.bat  # ???? 1
# ? forceUpdate: false ??? ????
```

---

## ?? ??? ?? ???? ???? Reload:

### 1. ???? Console:
```javascript
// ??? ?? ???:
? Version Manager: Initializing...
?? Current Version: 1.0.1
?? Server Version: 1.0.1
?? Force Update: false  ? ??? false
? App is up to date
```

### 2. ??? ???:
```javascript
?? Force Update: true  ? ???????!
```

**????:**
1. ???? ??????? (Ctrl+C)
2. ???? `version.json`
3. ???? `"forceUpdate": true` ? `"forceUpdate": false`
4. ????
5. ???? ??????? ??? ????

### 3. ??? ?????? ???????:
```powershell
# ???? ?? ??? ????? ?? ????
dotnet clean
dotnet build
dotnet run
```

---

## ?? ????? ??? Normal ? Force:

| ?????? | Normal Update | Force Update |
|--------|---------------|--------------|
| **forceUpdate** | false | true |
| **???????** | 5 ????? | ???? |
| **Reload** | ??? ????? | ????? |
| **?????????** | ?????? | ???? ???? |

---

## ? Checklist ???????:

```markdown
? ? version.json ? forceUpdate: false
? ? localStorage ?????
? ? sessionStorage ?????
? ? caches ??????
? ? service workers unregistered
? ? ??????? ???? ???? reload
? ? Console ???? ?????
? ? Toast ???? ?? ???? (?? ???)
```

---

## ?? ???????:

### ???????:
```json
{
  "forceUpdate": true  ? ?
}
```

### ????:
```json
{
  "forceUpdate": false  ? ?
}
```

**+ ??? localStorage + reload**

---

<div align="center">

**? ???? ??? ?? ???? ??????? ???? ?????!**

**?? ??????: ???? DEPLOYMENT_GUIDE.md**

</div>
