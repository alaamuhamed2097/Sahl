@inject NavigationManager NavigationManager

@code {
    protected override void OnInitialized()
    {
        var currentPath = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        
        // Don't redirect if already on login page (prevents loops)
        if (currentPath.StartsWith("login", StringComparison.OrdinalIgnoreCase))
        {
            return;
        }
        
        var returnUrl = Uri.EscapeDataString(currentPath);
        NavigationManager.NavigateTo($"/login?returnUrl={returnUrl}", forceLoad: false);
    }
}
