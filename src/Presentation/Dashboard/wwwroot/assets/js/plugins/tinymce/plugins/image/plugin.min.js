(function(n){"use strict";function oo(t){var i=function(i,r,u,f){var e,o;e=new n.XMLHttpRequest;e.open("POST",t.url);e.withCredentials=t.credentials;e.upload.onprogress=function(n){f(n.loaded/n.total*100)};e.onerror=function(){u("Image upload failed due to a XHR Transport error. Code: "+e.status)};e.onload=function(){var n;if(e.status<200||e.status>=300){u("HTTP Error: "+e.status);return}if(n=JSON.parse(e.responseText),!n||typeof n.location!="string"){u("Invalid JSON: "+e.responseText);return}r(eo(t.basePath,n.location))};o=new n.FormData;o.append("file",i.blob(),i.filename());e.send(o)},r=function(n,t){return new ct(function(i,r){try{t(n,i,r,et)}catch(u){r(u.message)}})},u=function(n){return n===i},f=function(n){return!t.url&&u(t.handler)?ct.reject("Upload url missing from the settings."):r(n,t.handler)};return t=vt.extend({credentials:!1,handler:i},t),{upload:f}}function hh(){ar.add("image",function(n){eh.setup(n);sh.register(n);rh.register(n)})}var ar=tinymce.util.Tools.resolve("tinymce.PluginManager"),et=function(){},s=function(n){return function(){return n}},vr=function(n){return n},yr=function(n){return function(){throw new Error(n);}},h=s(!1),a=s(!0),rt=function(){return ot},ot=function(){var n=function(n){return n.isNone()},t=function(n){return n()},i=function(n){return n},r={fold:function(n){return n()},is:h,isSome:h,isNone:a,getOr:i,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.");},getOrNull:s(null),getOrUndefined:s(undefined),or:i,orThunk:t,map:rt,each:et,bind:rt,exists:h,forall:a,filter:rt,equals:n,equals_:n,toArray:function(){return[]},toString:s("none()")};return Object.freeze&&Object.freeze(r),r}(),st=function(n){var t=s(n),u=function(){return r},i=function(t){return t(n)},r={fold:function(t,i){return i(n)},is:function(t){return n===t},isSome:a,isNone:h,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:u,orThunk:u,map:function(t){return st(t(n))},each:function(t){t(n)},bind:i,exists:i,forall:i,filter:function(t){return t(n)?r:ot},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,i){return t.fold(h,function(t){return i(n,t)})}};return r},pr=function(n){return n===null||n===undefined?ot:st(n)},r={some:st,none:rt,from:pr},wr=function(n){if(n===null)return"null";var t=typeof n;return t==="object"&&(Array.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="String")?"string":t},v=function(n){return function(t){return wr(t)===n}},u=v("string"),bt=v("object"),br=v("array"),kt=v("boolean"),kr=v("function"),dr=v("number"),gr=Array.prototype.slice,nu=Array.prototype.push,tu=function(n,t){for(var u,i=0,r=n.length;i<r;i++)u=n[i],t(u,i)},ut=function(n){for(var i=[],t=0,r=n.length;t<r;++t){if(!br(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);nu.apply(i,n[t])}return i},iu=function(n){return n.length===0?r.none():r.some(n[0])},ch=kr(Array.from)?Array.from:function(n){return gr.call(n)},ru=function(n,t){for(var u,i=0;i<n.length;i++)if(u=t(n[i],i),u.isSome())return u;return r.none()},y=function(){return y=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},y.apply(this,arguments)},dt={},gt={exports:dt};(function(n,t,i,r){(function(r){if(typeof t=="object"&&typeof i!="undefined")i.exports=r();else if(typeof n=="function"&&n.amd)n([],r);else{var u;u=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;u.EphoxContactWrapper=r()}})(function(){return function(){function n(t,i,u){function f(e,s){var c,l,h;if(!i[e]){if(!t[e]){if(c="function"==typeof r&&r,!s&&c)return c(e,!0);if(o)return o(e,!0);l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l;}h=i[e]={exports:{}};t[e][0].call(h.exports,function(n){var i=t[e][1][n];return f(i||n)},h,h.exports,n,t,i,u)}return i[e].exports}for(var o="function"==typeof r&&r,e=0;e<u.length;e++)f(u[e]);return f}return n}()({1:[function(n,t){function c(){throw new Error("setTimeout has not been defined");}function l(){throw new Error("clearTimeout has not been defined");}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===c||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}function p(n){if(u===clearTimeout)return clearTimeout(n);if((u===l||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(n);try{return u(n)}catch(t){try{return u.call(null,n)}catch(t){return u.call(this,n)}}}function w(){s&&o&&(s=!1,o.length?f=o.concat(f):h=-1,f.length&&v())}function v(){var t,n;if(!s){for(t=a(w),s=!0,n=f.length;n;){for(o=f,f=[];++h<n;)o&&o[h].run();h=-1;n=f.length}o=null;s=!1;p(t)}}function y(n,t){this.fun=n;this.array=t}function e(){}var i=t.exports={},r,u;(function(){try{r=typeof setTimeout=="function"?setTimeout:c}catch(n){r=c}try{u=typeof clearTimeout=="function"?clearTimeout:l}catch(n){u=l}})();var f=[],s=!1,o,h=-1;i.nextTick=function(n){var i=new Array(arguments.length-1),t;if(arguments.length>1)for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];f.push(new y(n,i));f.length!==1||s||a(v)};y.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};i.on=e;i.addListener=e;i.once=e;i.off=e;i.removeListener=e;i.removeAllListeners=e;i.emit=e;i.prependListener=e;i.prependOnceListener=e;i.listeners=function(){return[]};i.binding=function(){throw new Error("process.binding is not supported");};i.cwd=function(){return"/"};i.chdir=function(){throw new Error("process.chdir is not supported");};i.umask=function(){return 0}},{}],2:[function(n,t){(function(n){(function(i){function c(){}function l(n,t){return function(){n.apply(t,arguments)}}function r(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];s(n,this)}function o(n,t){while(n._state===3)n=n._value;if(n._state===0){n._deferreds.push(t);return}n._handled=!0;r._immediateFn(function(){var i=n._state===1?t.onFulfilled:t.onRejected,r;if(i===null){(n._state===1?f:u)(t.promise,n._value);return}try{r=i(n._value)}catch(e){u(t.promise,e);return}f(t.promise,r)})}function f(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(typeof t=="object"||typeof t=="function")){var i=t.then;if(t instanceof r){n._state=3;n._value=t;e(n);return}if(typeof i=="function"){s(l(i,t),n);return}}n._state=1;n._value=t;e(n)}catch(f){u(n,f)}}function u(n,t){n._state=2;n._value=t;e(n)}function e(n){n._state===2&&n._deferreds.length===0&&r._immediateFn(function(){n._handled||r._unhandledRejectionFn(n._value)});for(var t=0,i=n._deferreds.length;t<i;t++)o(n,n._deferreds[t]);n._deferreds=null}function a(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function s(n,t){var i=!1;try{n(function(n){i||(i=!0,f(t,n))},function(n){i||(i=!0,u(t,n))})}catch(r){if(i)return;i=!0;u(t,r)}}var h=setTimeout;r.prototype["catch"]=function(n){return this.then(null,n)};r.prototype.then=function(n,t){var i=new this.constructor(c);return o(this,new a(n,t,i)),i};r.all=function(n){var t=Array.prototype.slice.call(n);return new r(function(n,i){function f(r,e){try{if(e&&(typeof e=="object"||typeof e=="function")){var o=e.then;if(typeof o=="function"){o.call(e,function(n){f(r,n)},i);return}}t[r]=e;--u==0&&n(t)}catch(s){i(s)}}var u,r;if(t.length===0)return n([]);for(u=t.length,r=0;r<t.length;r++)f(r,t[r])})};r.resolve=function(n){return n&&typeof n=="object"&&n.constructor===r?n:new r(function(t){t(n)})};r.reject=function(n){return new r(function(t,i){i(n)})};r.race=function(n){return new r(function(t,i){for(var r=0,u=n.length;r<u;r++)n[r].then(t,i)})};r._immediateFn=typeof n=="function"?function(t){n(t)}:function(n){h(n,0)};r._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};r._setImmediateFn=function(n){r._immediateFn=n};r._setUnhandledRejectionFn=function(n){r._unhandledRejectionFn=n};typeof t!="undefined"&&t.exports?t.exports=r:i.Promise||(i.Promise=r)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,i){(function(t,r){function u(n,t){this._id=n;this._clearFn=t}var o=n("process/browser.js").nextTick,e=Function.prototype.apply,s=Array.prototype.slice,f={},h=0;i.setTimeout=function(){return new u(e.call(setTimeout,window,arguments),clearTimeout)};i.setInterval=function(){return new u(e.call(setInterval,window,arguments),clearInterval)};i.clearTimeout=i.clearInterval=function(n){n.close()};u.prototype.unref=u.prototype.ref=function(){};u.prototype.close=function(){this._clearFn.call(window,this._id)};i.enroll=function(n,t){clearTimeout(n._idleTimeoutId);n._idleTimeout=t};i.unenroll=function(n){clearTimeout(n._idleTimeoutId);n._idleTimeout=-1};i._unrefActive=i.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))};i.setImmediate=typeof t=="function"?t:function(n){var t=h++,r=arguments.length<2?!1:s.call(arguments,1);return f[t]=!0,o(function(){f[t]&&(r?n.apply(null,r):n.call(null),i.clearImmediate(t))}),t};i.clearImmediate=typeof r=="function"?r:function(n){delete f[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t){var i=n("promise-polyfill"),r=function(){return typeof window!="undefined"?window:Function("return this;")()}();t.exports={boltExport:r.Promise||i}},{"promise-polyfill":2}]},{},[4])(4)})})(undefined,dt,gt,undefined);var ni=gt.exports.boltExport,ht=function(t){var i=r.none(),u=[],s=function(n){return ht(function(t){f(function(i){t(n(i))})})},f=function(n){e()?o(n):u.push(n)},h=function(n){i=r.some(n);c(u);u=[]},e=function(){return i.isSome()},c=function(n){tu(n,o)},o=function(t){i.each(function(i){n.setTimeout(function(){t(i)},0)})};return t(h),{get:f,map:s,isReady:e}},uu=function(n){return ht(function(t){t(n)})},fu={nu:ht,pure:uu},eu=function(t){n.setTimeout(function(){throw t;},0)},p=function(n){var t=function(t){n().then(t,eu)},i=function(t){return p(function(){return n().then(t)})},r=function(t){return p(function(){return n().then(function(n){return t(n).toPromise()})})},u=function(t){return p(function(){return n().then(function(){return t.toPromise()})})},f=function(){return fu.nu(t)},e=function(){var t=null;return p(function(){return t===null&&(t=n()),t})},o=n;return{map:i,bind:r,anonBind:u,toLazy:f,toCached:e,toPromise:o,get:t}},ou=function(n){return p(function(){return new ni(n)})},su=function(n){return p(function(){return ni.resolve(n)})},l={nu:ou,pure:su},w=function(n){var t=function(t){return n===t},i=function(){return w(n)},u=function(){return w(n)},f=function(t){return w(t(n))},e=function(){return w(n)},o=function(t){t(n)},c=function(t){return t(n)},l=function(t,i){return i(n)},v=function(t){return t(n)},y=function(t){return t(n)},p=function(){return r.some(n)};return{is:t,isValue:a,isError:h,getOr:s(n),getOrThunk:s(n),getOrDie:s(n),or:i,orThunk:u,fold:l,map:f,mapError:e,each:o,bind:c,exists:v,forall:y,toOption:p}},g=function(n){var t=function(n){return n()},i=function(){return yr(String(n))()},u=function(n){return n},f=function(n){return n()},e=function(){return g(n)},o=function(t){return g(t(n))},s=function(){return g(n)},c=function(t){return t(n)};return{is:h,isValue:h,isError:a,getOr:vr,getOrThunk:t,getOrDie:i,or:u,orThunk:f,fold:c,map:e,mapError:o,each:et,bind:s,exists:h,forall:a,toOption:r.none}},hu=function(n,t){return n.fold(function(){return g(t)},w)},c={value:w,error:g,fromOption:hu},e=function(t){var i=function(){return e(t.toCached())},r=function(n){return e(t.bind(function(t){return t.fold(function(n){return l.pure(c.error(n))},function(t){return n(t)})}))},u=function(n){return e(t.map(function(t){return t.bind(n)}))},f=function(n){return e(t.map(function(t){return t.map(n)}))},o=function(n){return e(t.map(function(t){return t.mapError(n)}))},s=function(n,i){return t.map(function(t){return t.fold(n,i)})},h=function(i,r){return e(l.nu(function(u){var f=!1,e=n.setTimeout(function(){f=!0;u(c.error(r()))},i);t.get(function(t){f||(n.clearTimeout(e),u(t))})}))};return y(y({},t),{toCached:i,bindFuture:r,bindResult:u,mapResult:f,mapError:o,foldResult:s,withTimeout:h})},ti=function(n){return e(l.nu(n))},ii=function(n){return e(l.pure(c.value(n)))},cu=function(n){return e(l.pure(c.error(n)))},lu=function(n){return e(l.pure(n))},au=function(n){return e(n.map(c.value))},vu=function(n){return ti(function(t){n.then(function(n){t(c.value(n))},function(n){t(c.error(n))})})},yu={nu:ti,wrap:e,pure:ii,value:ii,error:cu,fromResult:lu,fromFuture:au,fromPromise:vu},pu=Object.prototype.hasOwnProperty,wu=function(n,t){var i=bt(n)&&bt(t);return i?nt(n,t):t},bu=function(n){return function(){for(var u,f,e,i,t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];if(t.length===0)throw new Error("Can't merge zero objects");for(u={},f=0;f<t.length;f++){e=t[f];for(i in e)pu.call(e,i)&&(u[i]=n(u[i],e[i]))}return u}},nt=bu(wu),lh=n.Node.ATTRIBUTE_NODE,ah=n.Node.CDATA_SECTION_NODE,vh=n.Node.COMMENT_NODE,yh=n.Node.DOCUMENT_NODE,ph=n.Node.DOCUMENT_TYPE_NODE,wh=n.Node.DOCUMENT_FRAGMENT_NODE,bh=n.Node.ELEMENT_NODE,kh=n.Node.TEXT_NODE,dh=n.Node.PROCESSING_INSTRUCTION_NODE,gh=n.Node.ENTITY_REFERENCE_NODE,nc=n.Node.ENTITY_NODE,tc=n.Node.NOTATION_NODE,ic=typeof n.window!="undefined"?n.window:Function("return this;")(),ku=function(t,i,r){if(u(r)||kt(r)||dr(r))t.setAttribute(i,r+"");else{n.console.error("Invalid call to Attr.set. Key ",i,":: Value ",r,":: Element ",t);throw new Error("Attribute value was not simple");}},ri=function(n,t,i){ku(n.dom(),t,i)},du=function(t,i){var u=i||n.document,r=u.createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1){n.console.error("HTML does not have a single root node",t);throw new Error("HTML must have a single root node");}return tt(r.childNodes[0])},gu=function(t,i){var r=i||n.document,u=r.createElement(t);return tt(u)},nf=function(t,i){var r=i||n.document,u=r.createTextNode(t);return tt(u)},tt=function(n){if(n===null||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:s(n)}},tf=function(n,t,i){var u=n.dom();return r.from(u.elementFromPoint(t,i)).map(tt)},ui={fromHtml:du,fromTag:gu,fromText:nf,fromDom:tt,fromPoint:tf},rf=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ct=tinymce.util.Tools.resolve("tinymce.util.Promise"),uf=tinymce.util.Tools.resolve("tinymce.util.XHR"),ff=function(n){return n.getParam("image_dimensions",!0,"boolean")},ef=function(n){return n.getParam("image_advtab",!1,"boolean")},sf=function(n){return n.getParam("image_uploadtab",!0,"boolean")},hf=function(n){return n.getParam("image_prepend_url","","string")},cf=function(n){return n.getParam("image_class_list")},lf=function(n){return n.getParam("image_description",!0,"boolean")},af=function(n){return n.getParam("image_title",!1,"boolean")},vf=function(n){return n.getParam("image_caption",!1,"boolean")},yf=function(n){return n.getParam("image_list",!1)},pf=function(n){return!!fi(n)},wf=function(n){return!!ei(n)},fi=function(n){return n.getParam("images_upload_url","","string")},ei=function(n){return n.getParam("images_upload_handler",undefined,"function")},bf=function(n){return n.getParam("images_upload_base_path",undefined,"string")},kf=function(n){return n.getParam("images_upload_credentials",!1,"boolean")},df=function(n){return n.getParam("a11y_advanced_options",!1,"boolean")},gf=function(n){return n.getParam("automatic_uploads",!0,"boolean")},i={hasDimensions:ff,hasUploadTab:sf,hasAdvTab:ef,getPrependUrl:hf,getClassList:cf,hasDescription:lf,hasImageTitle:af,hasImageCaption:vf,getImageList:yf,hasUploadUrl:pf,hasUploadHandler:wf,getUploadUrl:fi,getUploadHandler:ei,getUploadBasePath:bf,getUploadCredentials:kf,showAccessibilityOptions:df,isAutomaticUploadsEnabled:gf},oi=function(n,t){return Math.max(parseInt(n,10),parseInt(t,10))},ne=function(t,i){var r=n.document.createElement("img"),f=function(n){r.parentNode&&r.parentNode.removeChild(r);i(n)},u;r.onload=function(){var n=oi(r.width,r.clientWidth),t=oi(r.height,r.clientHeight),i={width:n,height:t};f(c.value(i))};r.onerror=function(){f(c.error("Failed to get image dimensions for: "+t))};u=r.style;u.visibility="hidden";u.position="fixed";u.bottom=u.left="0px";u.width=u.height="auto";n.document.body.appendChild(r);r.src=t},te=function(n){return n&&(n=n.replace(/px$/,"")),n},ie=function(n){return n.length>0&&/^[0-9]+$/.test(n)&&(n+="px"),n},re=function(n){if(n.margin){var t=String(n.margin).split(" ");switch(t.length){case 1:n["margin-top"]=n["margin-top"]||t[0];n["margin-right"]=n["margin-right"]||t[0];n["margin-bottom"]=n["margin-bottom"]||t[0];n["margin-left"]=n["margin-left"]||t[0];break;case 2:n["margin-top"]=n["margin-top"]||t[0];n["margin-right"]=n["margin-right"]||t[1];n["margin-bottom"]=n["margin-bottom"]||t[0];n["margin-left"]=n["margin-left"]||t[1];break;case 3:n["margin-top"]=n["margin-top"]||t[0];n["margin-right"]=n["margin-right"]||t[1];n["margin-bottom"]=n["margin-bottom"]||t[2];n["margin-left"]=n["margin-left"]||t[1];break;case 4:n["margin-top"]=n["margin-top"]||t[0];n["margin-right"]=n["margin-right"]||t[1];n["margin-bottom"]=n["margin-bottom"]||t[2];n["margin-left"]=n["margin-left"]||t[3]}delete n.margin}return n},ue=function(n,t){var r=i.getImageList(n);typeof r=="string"?uf.send({url:r,success:function(n){t(JSON.parse(n))}}):typeof r=="function"?r(t):t(r)},fe=function(n,t,r){var u=function(){r.onload=r.onerror=null;n.selection&&(n.selection.select(r),n.nodeChanged())};r.onload=function(){t.width||t.height||!i.hasDimensions(n)||n.dom.setAttribs(r,{width:String(r.clientWidth),height:String(r.clientHeight)});u()};r.onerror=u},ee=function(t){return new ct(function(i,r){var u=new n.FileReader;u.onload=function(){i(u.result)};u.onerror=function(){r(u.error.message)};u.readAsDataURL(t)})},oe=function(n){return n.nodeName==="IMG"&&(n.hasAttribute("data-mce-object")||n.hasAttribute("data-mce-placeholder"))},t={getImageSize:ne,removePixelSuffix:te,addPixelSuffix:ie,mergeMargins:re,createImageList:ue,waitLoadImage:fe,blobToDataUri:ee,isPlaceholderImage:oe},f=rf.DOM,si=function(n){return n.style.marginLeft&&n.style.marginRight&&n.style.marginLeft===n.style.marginRight?t.removePixelSuffix(n.style.marginLeft):""},hi=function(n){return n.style.marginTop&&n.style.marginBottom&&n.style.marginTop===n.style.marginBottom?t.removePixelSuffix(n.style.marginTop):""},ci=function(n){return n.style.borderWidth?t.removePixelSuffix(n.style.borderWidth):""},b=function(n,t){return n.hasAttribute(t)?n.getAttribute(t):""},li=function(n,t){return n.style[t]?n.style[t]:""},ai=function(n){return n.parentNode!==null&&n.parentNode.nodeName==="FIGURE"},k=function(n,t,i){n.setAttribute(t,i)},se=function(n){var t=f.create("figure",{"class":"image"});f.insertAfter(t,n);t.appendChild(n);t.appendChild(f.create("figcaption",{contentEditable:"true"},"Caption"));t.contentEditable="false"},he=function(n){var t=n.parentNode;f.insertAfter(n,t);f.remove(t)},ce=function(n){ai(n)?he(n):se(n)},vi=function(n,t){var r=n.getAttribute("style"),i=t(r!==null?r:"");i.length>0?(n.setAttribute("style",i),n.setAttribute("data-mce-style",i)):n.removeAttribute("style")},yi=function(n,i){return function(n,r,u){n.style[r]?(n.style[r]=t.addPixelSuffix(u),vi(n,i)):k(n,r,u)}},pi=function(n,i){return n.style[i]?t.removePixelSuffix(n.style[i]):b(n,i)},wi=function(n,i){var r=t.addPixelSuffix(i);n.style.marginLeft=r;n.style.marginRight=r},bi=function(n,i){var r=t.addPixelSuffix(i);n.style.marginTop=r;n.style.marginBottom=r},ki=function(n,i){var r=t.addPixelSuffix(i);n.style.borderWidth=r},di=function(n,t){n.style.borderStyle=t},le=function(n){return li(n,"borderStyle")},lt=function(n){return n.nodeName==="FIGURE"},ae=function(n){return n.nodeName==="IMG"},gi=function(n){return f.getAttrib(n,"alt").length===0&&f.getAttrib(n,"role")==="presentation"},ve=function(n){return gi(n)?"":b(n,"alt")},ye=function(){return{src:"",alt:"",title:"",width:"",height:"","class":"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}},pe=function(t,i){var r=n.document.createElement("img");return k(r,"style",i.style),(si(r)||i.hspace!=="")&&wi(r,i.hspace),(hi(r)||i.vspace!=="")&&bi(r,i.vspace),(ci(r)||i.border!=="")&&ki(r,i.border),(le(r)||i.borderStyle!=="")&&di(r,i.borderStyle),t(r.getAttribute("style"))},we=function(t,i,r){var e=n.document.createElement("img"),u;return ir(t,y(y({},i),{caption:!1}),e,r),tr(e,i.alt,i.isDecorative,r),i.caption?(u=f.create("figure",{"class":"image"}),u.appendChild(e),u.appendChild(f.create("figcaption",{contentEditable:"true"},"Caption")),u.contentEditable="false",u):e},nr=function(n,t){return{src:b(t,"src"),alt:ve(t),title:b(t,"title"),width:pi(t,"width"),height:pi(t,"height"),"class":b(t,"class"),style:n(b(t,"style")),caption:ai(t),hspace:si(t),vspace:hi(t),border:ci(t),borderStyle:li(t,"borderStyle"),isDecorative:gi(t)}},o=function(n,t,i,r,u){i[r]!==t[r]&&u(n,r,i[r])},tr=function(n,t,i,r){var u;i?(f.setAttrib(n,"role","presentation"),u=ui.fromDom(n),ri(u,"alt","")):(r.hasAccessibilityOptions?f.setAttrib(n,"alt",t):(u=ui.fromDom(n),ri(u,"alt",t)),f.getAttrib(n,"role")==="presentation"&&f.setAttrib(n,"role",""))},be=function(n,t,i,r){(i.alt!==t.alt||i.isDecorative!==t.isDecorative)&&tr(n,i.alt,i.isDecorative,r)},it=function(n,t){return function(i,r,u){n(i,u);vi(i,t)}},ir=function(n,t,i,r){var u=nr(n,i);o(i,u,t,"caption",function(n){return ce(n)});o(i,u,t,"src",k);o(i,u,t,"title",k);o(i,u,t,"width",yi("width",n));o(i,u,t,"height",yi("height",n));o(i,u,t,"class",k);o(i,u,t,"style",it(function(n,t){return k(n,"style",t)},n));o(i,u,t,"hspace",it(wi,n));o(i,u,t,"vspace",it(bi,n));o(i,u,t,"border",it(ki,n));o(i,u,t,"borderStyle",it(di,n));be(i,u,t,r)},ft=function(n,i){var r=n.dom.styles.parse(i),u=t.mergeMargins(r),f=n.dom.styles.parse(n.dom.styles.serialize(u));return n.dom.styles.serialize(f)},at=function(n){var i=n.selection.getNode(),r=n.dom.getParent(i,"figure.image");return r?n.dom.select("img",r)[0]:i&&(i.nodeName!=="IMG"||t.isPlaceholderImage(i))?null:i},rr=function(n,t){var i=n.dom,r=i.getParent(t.parentNode,function(t){return!!n.schema.getTextBlockElements()[t.nodeName]},n.getBody());return r?i.split(r,t):t},ke=function(n){var t=at(n);return t?nr(function(t){return ft(n,t)},t):ye()},de=function(n,t,i){var u=we(function(t){return ft(n,t)},t,i),r,f;n.dom.setAttrib(u,"data-mce-id","__mcenew");n.focus();n.selection.setContent(u.outerHTML);r=n.dom.select('*[data-mce-id="__mcenew"]')[0];n.dom.setAttrib(r,"data-mce-id",null);lt(r)?(f=rr(n,r),n.selection.select(f)):n.selection.select(r)},ge=function(n,t){n.dom.setAttrib(t,"src",t.getAttribute("src"))},no=function(n,t){if(t){var i=n.dom.is(t.parentNode,"figure.image")?t.parentNode:t;n.dom.remove(i);n.focus();n.nodeChanged();n.dom.isEmpty(n.getBody())&&(n.setContent(""),n.selection.setCursorLocation())}},to=function(n,i,r){var u=at(n),f;ir(function(t){return ft(n,t)},i,u,r);ge(n,u);lt(u.parentNode)?(f=u.parentNode,rr(n,f),n.selection.select(u.parentNode)):(n.selection.select(u),t.waitLoadImage(n,i,u))},io=function(n,t,i){var r=at(n);r?t.src?to(n,t,i):no(n,r):t.src&&de(n,t,i)},vt=tinymce.util.Tools.resolve("tinymce.util.Tools"),ur=function(n){return u(n.value)?n.value:""},fr=function(n,t){var i=[];return vt.each(n,function(n){var r=u(n.text)?n.text:u(n.title)?n.title:"",f,e;n.menu!==undefined?(f=fr(n.menu,t),i.push({text:r,items:f})):(e=t(n),i.push({text:r,value:e}))}),i},er=function(n){return n===void 0&&(n=ur),function(t){return t?r.from(t).map(function(t){return fr(t,n)}):r.none()}},ro=function(n){return er(ur)(n)},uo=function(n){return Object.prototype.hasOwnProperty.call(n,"items")},or=function(n,t){return ru(n,function(n){return uo(n)?or(n.items,t):n.value===t?r.some(n):r.none()})},fo=function(n,t){return n.bind(function(n){return or(n,t)})},d={sanitizer:er,sanitize:ro,findEntry:fo},eo=function(n,t){return n?n.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t};var so=function(){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"selectbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},ho={makeTab:so},co=function(n){var f=d.sanitizer(function(t){return n.convertURL(t.value||t.url,"src")}),e=l.nu(function(i){t.createImageList(n,function(n){i(f(n).map(function(n){return ut([[{text:"None",value:""}],n])}))})}),o=d.sanitize(i.getClassList(n)),s=i.hasAdvTab(n),h=i.hasUploadTab(n),c=i.hasUploadUrl(n),a=i.hasUploadHandler(n),v=ke(n),y=i.hasDescription(n),p=i.hasImageTitle(n),w=i.hasDimensions(n),b=i.hasImageCaption(n),k=i.showAccessibilityOptions(n),g=i.getUploadUrl(n),nt=i.getUploadBasePath(n),tt=i.getUploadCredentials(n),it=i.getUploadHandler(n),rt=i.isAutomaticUploadsEnabled(n),ft=r.some(i.getPrependUrl(n)).filter(function(n){return u(n)&&n.length>0});return e.map(function(n){return{image:v,imageList:n,classList:o,hasAdvTab:s,hasUploadTab:h,hasUploadUrl:c,hasUploadHandler:a,hasDescription:y,hasImageTitle:p,hasDimensions:w,hasImageCaption:b,url:g,basePath:nt,credentials:tt,handler:it,prependURL:ft,hasAccessibilityOptions:k,automaticUploads:rt}})},sr=function(n){var t=n.imageList.map(function(n){return{name:"images",type:"selectbox",label:"Image list",items:n}}),i={name:"alt",type:"input",label:"Alternative description",disabled:n.hasAccessibilityOptions&&n.image.isDecorative},r=n.classList.map(function(n){return{name:"classes",type:"selectbox",label:"Class",items:n}});return ut([[{name:"src",type:"urlinput",filetype:"image",label:"Source"}],t.toArray(),n.hasAccessibilityOptions&&n.hasDescription?[{type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]}]:[],n.hasDescription?[i]:[],n.hasImageTitle?[{name:"title",type:"input",label:"Image title"}]:[],n.hasDimensions?[{name:"dimensions",type:"sizeinput"}]:[],[{type:"grid",columns:2,items:ut([r.toArray(),n.hasImageCaption?[{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[]])}]])},lo=function(n){return{title:"General",name:"general",items:sr(n)}},hr={makeTab:lo,makeItems:sr},ao=function(){return{title:"Upload",name:"upload",items:[{type:"dropzone",name:"fileinput"}]}},vo={makeTab:ao},yo=function(n){return{prevImage:d.findEntry(n.imageList,n.image.src),prevAlt:n.image.alt,open:!0}},yt=function(n){return{src:{value:n.src,meta:{}},images:n.src,alt:n.alt,title:n.title,dimensions:{width:n.width,height:n.height},classes:n.class,caption:n.caption,style:n.style,vspace:n.vspace,border:n.border,hspace:n.hspace,borderstyle:n.borderStyle,fileinput:[],isDecorative:n.isDecorative}},cr=function(n){return{src:n.src.value,alt:n.alt,title:n.title,width:n.dimensions.width,height:n.dimensions.height,"class":n.classes,style:n.style,caption:n.caption,hspace:n.hspace,vspace:n.vspace,border:n.border,borderStyle:n.borderstyle,isDecorative:n.isDecorative}},po=function(n,t){return/^(?:[a-zA-Z]+:)?\/\//.test(t)?r.none():n.prependURL.bind(function(n){return t.substring(0,n.length)!==n?r.some(n+t):r.none()})},wo=function(n,t){var i=t.getData();po(n,i.src.value).each(function(n){t.setData({src:{value:n,meta:i.src.meta}})})},bo=function(n,t,i){n.hasDescription&&u(i.alt)&&(t.alt=i.alt);n.hasAccessibilityOptions&&(t.isDecorative=i.isDecorative||!1);n.hasImageTitle&&u(i.title)&&(t.title=i.title);n.hasDimensions&&(u(i.width)&&(t.dimensions.width=i.width),u(i.height)&&(t.dimensions.height=i.height));u(i.class)&&d.findEntry(n.classList,i.class).each(function(n){t.classes=n.value});n.hasImageCaption&&kt(i.caption)&&(t.caption=i.caption);n.hasAdvTab&&(u(i.style)&&(t.style=i.style),u(i.vspace)&&(t.vspace=i.vspace),u(i.border)&&(t.border=i.border),u(i.hspace)&&(t.hspace=i.hspace),u(i.borderstyle)&&(t.borderstyle=i.borderstyle))},ko=function(n,t){var r=t.getData(),u=r.src.meta,i;u!==undefined&&(i=nt({},r),bo(n,i,u),t.setData(i))},go=function(n,t,i,r){var u=r.getData(),e=u.src.value,f=u.src.meta||{};f.width||f.height||!t.hasDimensions||n.imageSize(e).get(function(n){n.each(function(n){i.open&&r.setData({dimensions:n})})})},ns=function(n,t,i){var u=i.getData(),r=d.findEntry(n.imageList,u.src.value);t.prevImage=r;i.setData({images:r.map(function(n){return n.value}).getOr("")})},pt=function(n,t,i,r){wo(t,r);ko(t,r);go(n,t,i,r);ns(t,i,r)},ts=function(n,t,i,r){var u=r.getData(),f=d.findEntry(t.imageList,u.images);f.each(function(n){var t=u.alt===""||i.prevImage.map(function(n){return n.text===u.alt}).getOr(!1);t?n.value===""?r.setData({src:n,alt:i.prevAlt}):r.setData({src:n,alt:n.text}):r.setData({src:n})});i.prevImage=f;pt(n,t,i,r)},is=function(n){var i=n["margin-top"]&&n["margin-bottom"]&&n["margin-top"]===n["margin-bottom"];return i?t.removePixelSuffix(String(n["margin-top"])):""},rs=function(n){var i=n["margin-right"]&&n["margin-left"]&&n["margin-right"]===n["margin-left"];return i?t.removePixelSuffix(String(n["margin-right"])):""},us=function(n){return n["border-width"]?t.removePixelSuffix(String(n["border-width"])):""},fs=function(n){return n["border-style"]?String(n["border-style"]):""},es=function(n,t,i){return t(n(t(i)))},os=function(n,i,r){var f=t.mergeMargins(n(r.style)),u=nt({},r);return u.vspace=is(f),u.hspace=rs(f),u.border=us(f),u.borderstyle=fs(f),u.style=es(n,i,f),u},ss=function(n,t){var i=t.getData(),r=os(n.parseStyle,n.serializeStyle,i);t.setData(r)},hs=function(n,t,i){var r=nt(yt(t.image),i.getData()),u=pe(n.normalizeCss,cr(r));i.setData({style:u})},cs=function(i,r,u,f){var e=f.getData();f.block("Uploading image");iu(e.fileinput).fold(function(){f.unblock()},function(e){var o=n.URL.createObjectURL(e),c=oo({url:r.url,basePath:r.basePath,credentials:r.credentials,handler:r.handler}),s=function(){f.unblock();n.URL.revokeObjectURL(o)},h=function(n){f.setData({src:{value:n,meta:{}}});f.showTab("general");pt(i,r,u,f)};t.blobToDataUri(e).then(function(n){var t=i.createBlobCache(e,o,n);r.automaticUploads?c.upload(t).then(function(n){h(n);s()}).catch(function(n){s();i.alertErr(f,n)}):(i.addToBlobCache(t),h(t.blobUri()),f.unblock())})})},ls=function(n,t,i){return function(r,u){u.name==="src"?pt(n,t,i,r):u.name==="images"?ts(n,t,i,r):u.name==="alt"?i.prevAlt=r.getData().alt:u.name==="style"?ss(n,r):u.name==="vspace"||u.name==="hspace"||u.name==="border"||u.name==="borderstyle"?hs(n,t,r):u.name==="fileinput"?cs(n,t,i,r):u.name==="isDecorative"&&(r.getData().isDecorative?r.disable("alt"):r.enable("alt"))}},as=function(n){return function(){n.open=!1}},vs=function(n){return n.hasAdvTab||n.hasUploadUrl||n.hasUploadHandler?{type:"tabpanel",tabs:ut([[hr.makeTab(n)],n.hasAdvTab?[ho.makeTab(n)]:[],n.hasUploadTab&&(n.hasUploadUrl||n.hasUploadHandler)?[vo.makeTab(n)]:[]])}:{type:"panel",items:hr.makeItems(n)}},ys=function(n){return function(t){var i=yo(t);return{title:"Insert/Edit Image",size:"normal",body:vs(t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:yt(t.image),onSubmit:n.onSubmit(t),onChange:ls(n,t,i),onClose:as(i)}}},ps=function(n){return function(t){return function(i){var r=nt(yt(t.image),i.getData());n.undoManager.transact(function(){io(n,cr(r),t)});n.editorUpload.uploadImagesAuto();i.close()}}},ws=function(n){return function(i){return yu.nu(function(r){t.getImageSize(n.documentBaseURI.toAbsolute(i),function(n){var t=n.map(function(n){return{width:String(n.width),height:String(n.height)}});r(t)})})}},bs=function(n){return function(t,i,r){return n.editorUpload.blobCache.create({blob:t,blobUri:i,name:t.name?t.name.replace(/\.[^\.]+$/,""):null,base64:r.split(",")[1]})}},ks=function(n){return function(t){n.editorUpload.blobCache.add(t)}},ds=function(n){return function(t,i){n.windowManager.alert(i,t.close)}},gs=function(n){return function(t){return ft(n,t)}},nh=function(n){return function(t){return n.dom.parseStyle(t)}},th=function(n){return function(t,i){return n.dom.serializeStyle(t,i)}},wt=function(n){var t={onSubmit:ps(n),imageSize:ws(n),addToBlobCache:ks(n),createBlobCache:bs(n),alertErr:ds(n),normalizeCss:gs(n),parseStyle:nh(n),serializeStyle:th(n)},i=function(){return co(n).map(ys(t)).get(function(t){n.windowManager.open(t)})};return{open:i}},ih=function(n){n.addCommand("mceImage",wt(n).open)},rh={register:ih},uh=function(n){var t=n.attr("class");return t&&/\bimage\b/.test(t)},lr=function(n){return function(t){for(var r=t.length,u=function(t){t.attr("contenteditable",n?"true":null)},i;r--;)i=t[r],uh(i)&&(i.attr("contenteditable",n?"false":null),vt.each(i.getAll("figcaption"),u))}},fh=function(n){n.on("PreInit",function(){n.parser.addNodeFilter("figure",lr(!0));n.serializer.addNodeFilter("figure",lr(!1))})},eh={setup:fh},oh=function(n){n.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:wt(n).open,onSetup:function(t){return n.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",t.setActive).unbind}});n.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:wt(n).open});n.ui.registry.addContextMenu("image",{update:function(n){return lt(n)||ae(n)&&!t.isPlaceholderImage(n)?["image"]:[]}})},sh={register:oh};hh()})(window);