<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <base href="/" />
    <title>ÿ®ÿ≥Ÿäÿ∑ | Basit</title>

    <link rel="icon" type="image/x-icon" href="/assets/images/favicon.png" />

    <!-- Critical Resource Hints for LCP Optimization -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />

    <!-- Bunny Fonts - Almarai -->
    <link rel="stylesheet" href="https://fonts.bunny.net/css?family=almarai:300,400,700,800">

    <!-- LCP Critical: Preload hero logo with highest priority -->
    <link rel="preload" href="/assets/images/logogt.webp" as="image" fetchpriority="high" />

    <!-- ‚úÖ CRITICAL: Load Version Manager FIRST (before everything else) -->
    <!--<script src="js/version-manager.js"></script>-->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet" />
    <script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
    <script src="js/quillInterop.js"></script>
    <!-- Critical Path: Inline critical CSS for immediate rendering -->
    <style>
        .select2.select2-container.select2-container--bootstrap-5 {
            border: solid 1px #e2e8f0 !important;
            border-radius: 8px !important
        }

        .select2-selection--single {
            margin-top: 10px;
            height: auto !important;
        }

        /* Inline Critical CSS for LCP optimization */
        .loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .loading-logo-img {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        .loading-text {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .loading-subtitle {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 20px;
        }

        .progress-container {
            width: 200px;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 100%;
            background: #fff;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        @keyframes pulse {
            from {
                transform: scale(1);
            }

            to {
                transform: scale(1.05);
            }
        }

        /* Hide app content until Blazor loads */
        #blazor-app {
            display: none;
        }

        body.loaded #loading-screen {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }

        body.loaded #blazor-app {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>

    <!-- Critical CSS - Load synchronously for immediate render -->
    <link rel="stylesheet" href="css/loader.min.css" media="all" />
    <link rel="stylesheet" href="css/app.min.css" media="all" />
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css" />

    <!-- Preload critical JavaScript with high priority -->
    <link rel="preload" href="_framework/blazor.webassembly.js" as="script" fetchpriority="high" />
    <link rel="preload" href="Common/Scripts/ScriptLoader.min.js" as="script" fetchpriority="high" />
    <link rel="preload" href="assets/js/jQuery-3.3.1.min.js" as="script" fetchpriority="high" />
    <link rel="preload" href="assets/plugins/bootstrap/js/popper.min.js" as="script" />
    <link rel="preload" href="assets/plugins/bootstrap/js/bootstrap.min.js" as="script" />
    <link rel="preload" href="Common/language/localization.js" as="script" fetchpriority="high" />

    <!-- Preload secondary CSS but load asynchronously -->
    <link rel="preload" href="css/notification.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="preload" href="css/toastNotifications.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="preload" href="css/perfect-scrollbar.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="preload" href="assets/css/style.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />

    <!-- Fallback for browsers that don't support preload -->
    <noscript>
        <link rel="stylesheet" href="css/notification.min.css" />
        <link rel="stylesheet" href="css/toastNotifications.min.css" />
        <link rel="stylesheet" href="css/perfect-scrollbar.min.css" />
        <link rel="stylesheet" href="assets/css/style.min.css" />
    </noscript>

    <!-- Load font CSS asynchronously with low priority -->
    <link rel="preload" href="assets/fonts/fontawesome/css/fontawesome-all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="preload" href="assets/fonts/material/css/materialdesignicons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="preload" href="assets/plugins/animation/css/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />

    <!-- ‚úÖ CRITICAL FIX: ŸÖŸÜÿπ debugger ŸÖŸÜ ÿßŸÑÿ™ŸÅÿπŸäŸÑ ŸÇÿ®ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ Blazor -->
    <script>
        // 1Ô∏è‚É£ ŸÖŸÜÿπ globalThis.dotnetDebugger ŸÖŸÜ ÿßŸÑÿ™ŸÅÿπŸäŸÑ
        Object.defineProperty(globalThis, 'dotnetDebugger', {
            get: function () { return undefined; },
            set: function () { },
            configurable: false,
            enumerable: false
        });

        // 2Ô∏è‚É£ ÿ™ÿ¨ÿßŸàÿ≤ console.assert ŸÑŸÖŸÜÿπ ÿßÿ≥ÿ™ÿØÿπÿßÿ° debugger
        const originalAssert = console.assert;
        console.assert = function (...args) {
            if (args.length > 0 && !args[0]) {
            }
            // ŸÑÿß ÿ™ÿ≥ÿ™ÿØÿπŸä originalAssert ŸÑÿ™ÿ¨ŸÜÿ® debugger statement
        };
    </script>

    <!-- Critical JavaScript - Load immediately -->
    <script>
        // Performance monitoring for LCP optimization
        window.performanceMetrics = {
            startTime: performance.now(),
            lcpCandidate: null,

            // Track LCP candidates
            observeLCP: function () {
                if ('PerformanceObserver' in window) {
                    const observer = new PerformanceObserver((list) => {
                        const entries = list.getEntries();
                        const lastEntry = entries[entries.length - 1];
                        this.lcpCandidate = lastEntry;
                    });
                    observer.observe({ entryTypes: ['largest-contentful-paint'] });
                }
            },

            // Progress tracking for better UX
            updateProgress: function (percentage) {
                const progressBar = document.getElementById('progress-bar');
                if (progressBar) {
                    progressBar.style.width = percentage + '%';
                }
            }
        };

        // Start LCP observation immediately
        window.performanceMetrics.observeLCP();

        // Simulate loading progress for better UX
        let progress = 0;
        const progressInterval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress > 90) progress = 90;
            window.performanceMetrics.updateProgress(progress);
        }, 100);

        // Clear interval when Blazor starts
        window.addEventListener('blazor-started', () => {
            clearInterval(progressInterval);
            window.performanceMetrics.updateProgress(100);
        });
    </script>

    <script src="Common/Scripts/ScriptLoader.min.js"></script>

    <!-- Load jQuery early - CRITICAL for menu functionality -->
    <script src="assets/js/jQuery-3.3.1.min.js"></script>

    <!-- Load Bootstrap dependencies BEFORE pcoded.min.js - CRITICAL FIX -->
    <script src="assets/plugins/bootstrap/js/popper.min.js"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>

    <!-- Load pcoded.mi-n.js immediately after Bootstrap - CRITICAL for menu functionality -->
    <script src="assets/js/pcoded.min.js"></script>

    <script defer src="assets/js/perfect-scrollbar-1.4.0.min.js"></script>

    <!-- Load localization early - CRITICAL for Blazor functionality -->
    <script src="Common/language/localization.js"></script>

    <!-- ‚úÖ CRITICAL: Load localStorage helper for preferences -->
    <script src="js/localStorage-helper.js"></script>

    <!-- ‚úÖ CRITICAL: Load HTTP Client helper for cookie-based authentication -->
    <script src="js/httpClientHelper.js"></script>

    <!-- Brand identity overrides -->
    <link href="assets/css/theme-identity.css" rel="stylesheet" />

    <!-- ‚ú® ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ© -->
    <link href="assets/css/enhancements/dashboard-cards-enhancement.css" rel="stylesheet" />
    <link href="assets/css/enhancements/sidebar-enhancement.css" rel="stylesheet" />
    <link href="assets/css/enhancements/buttons-enhancement.css" rel="stylesheet" />
    <link href="assets/css/enhancements/animations-library.css" rel="stylesheet" />
    <!--<link href="assets/css/enhancements/comprehensive-ui-enhancements.css" rel="stylesheet" />-->
</head>

<body class="loading hide-scrollbar">
    <div id="app">
        <!-- Optimized loading screen for better LCP -->
        <div class="loading-container" id="loading-screen">
            <!-- LCP Optimized: Direct img tag with fetchpriority high -->
            <img src="/assets/images/logogt.webp"
                 alt="ÿ®ÿ≥Ÿäÿ∑ | Basit Logo"
                 class="loading-logo-img"
                 fetchpriority="high"
                 width="80"
                 height="80"
                 decoding="sync"
                 onload="this.style.opacity='1'" />
            <div class="loading-text">ÿ®ÿ≥Ÿäÿ∑ | Basit</div>
            <div class="loading-subtitle">ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ<span class="loading-dots"></span></div>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div class="loading-tip" id="loading-tip">Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±ÿå ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ÿ∂Ÿäÿ± ÿßŸÑŸÜÿ∏ÿßŸÖ...</div>
            <div class="error-message" id="error-message" style="display: none;"></div>
        </div>

        <!-- Blazor app content -->
        <div id="blazor-app"></div>
    </div>

    <!-- Load Blazor WebAssembly with optimized loading -->
    <script src="_framework/blazor.webassembly.js" autostart="false"></script>
    <script>
        // jQuery dependency tracker
        window.jQueryReady = false;

        // Localization dependency tracker
        window.localizationReady = false;

        // Check if jQuery is loaded
        function checkjQueryLoaded() {
            return typeof $ !== 'undefined' && typeof jQuery !== 'undefined';
        }

        // Check if localization is loaded
        function checkLocalizationLoaded() {
            return typeof localization !== 'undefined' && typeof localization.getCurrentLanguage === 'function';
        }

        // Wait for jQuery to be available
        function waitForjQuery(callback) {
            if (checkjQueryLoaded()) {
                window.jQueryReady = true;
                callback();
            } else {
                setTimeout(() => waitForjQuery(callback), 50);
            }
        }

        // Wait for localization to be available
        function waitForLocalization(callback) {
            if (checkLocalizationLoaded()) {
                window.localizationReady = true;
                callback();
            } else {
                setTimeout(() => waitForLocalization(callback), 50);
            }
        }

        // Wait for all dependencies
        function waitForDependencies(callback) {
            const checkAndProceed = () => {
                if (checkjQueryLoaded() && checkLocalizationLoaded()) {
                    window.jQueryReady = true;
                    window.localizationReady = true;
                    callback();
                } else {
                    setTimeout(checkAndProceed, 50);
                }
            };
            checkAndProceed();
        }

        Blazor.start({
            loadBootResource: function(type, name, defaultUri, integrity) {
                // ‚úÖ ÿ≠ÿ∏ÿ± ŸÖŸÑŸÅÿßÿ™ ÿßŸÑŸÄ Debug
                if (name.endsWith('.pdb') ||
                    name.includes('.pdb.') ||
                    name === 'dotnet.native.wasm.symbols' ||
                    name.includes('debug') ||
                    name.includes('.dbg')) {
                    return null;
                }

                // ‚úÖ FIX ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä: ÿßŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ undefined URI
                if (!defaultUri || defaultUri === 'undefined') {
                    console.error(`[ERROR] Invalid URI for ${name}, trying to reconstruct...`);
                    // ÿ®ŸÜÿßÿ° ÿßŸÑŸÄ URI ŸäÿØŸàŸäÿßŸã
                    const baseHref = document.querySelector('base')?.getAttribute('href') || '/';
                    defaultUri = `${baseHref}_framework/${name}`;
                }

                // ‚úÖ ÿ•ÿ±ÿ¨ÿßÿπ ÿßŸÑŸÄ URI ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ®ÿØŸàŸÜ fetch ÿ•ÿ∂ÿßŸÅŸä
                // ÿßŸÑŸÄ Blazor runtime ŸáŸäÿπŸÖŸÑ fetch ÿ®ŸÜŸÅÿ≥Ÿá
                return defaultUri;
            },

            // ÿ™ÿπÿ∑ŸäŸÑ debugging ÿ™ŸÖÿßŸÖÿßŸã
            debugBuild: false,

            // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÑŸÑÿßÿ≥ÿ™ŸÇÿ±ÿßÿ±
            environment: 'Production'
        }).then(() => {
            document.body.classList.add('loaded');
            document.body.classList.remove('loading');

            window.dispatchEvent(new CustomEvent('blazor-started'));

            waitForDependencies(() => {
                initializeCriticalFeatures();
            });
        }).catch((error) => {
            console.error('‚ùå Blazor failed to start:', error);

            const errorMessage = document.getElementById('error-message');
            if (errorMessage) {
                errorMessage.style.display = 'block';
                errorMessage.textContent = 'ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ. Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿµŸÅÿ≠ÿ© (Ctrl+F5) ÿ£Ÿà ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿØÿπŸÖ ÿßŸÑŸÅŸÜŸä.';
                errorMessage.innerHTML += '<br><button onclick="location.reload(true)" style="margin-top:10px;padding:8px 16px;background:#0EA5E9;color:white;border:none;border-radius:4px;cursor:pointer;">ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©</button>';
            }

            const progressBar = document.getElementById('progress-bar');
            if (progressBar) {
                progressBar.style.width = '0%';
                progressBar.style.background = '#ef4444';
            }
        });
    </script>

    <!-- Deferred JavaScript - Load after Blazor initialization -->
    <script>
        // Load non-critical resources after Blazor starts
        window.addEventListener('blazor-started', function () {
            setTimeout(() => {
                const deferredScripts = [
                    'assets/plugins/sweetalert/js/sweetalert.min.js',
                    'assets/js/pages/ac-alert.min.js'
                ];

                deferredScripts.forEach((src, index) => {
                    setTimeout(() => {
                        const script = document.createElement('script');
                        script.src = src;
                        script.async = true;
                        document.head.appendChild(script);
                    }, index * 50);
                });
            }, 500);
        });
    </script>

    <!-- Service worker registration - Non-blocking -->
    <!--<script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                navigator.serviceWorker.register('service-worker.js').catch(function (error) {
                    console.log('Service worker registration failed:', error);
                });
            });
        }
    </script>-->

    <script>
        // Enhanced CSS Theme Loader for Blazor WebAssembly
        window.ThemeManager = {
            loadTheme: function (themeName) {
                const themeFiles = {
                    'layout-3': 'assets/css/layouts/layout-3.min.css',
                    'layout-4': 'assets/css/layouts/layout-4.min.css',
                    'layout-5': 'assets/css/layouts/layout-5.min.css',
                    'layout-9': 'assets/css/layouts/layout-9.min.css',
                    'layout-12': 'assets/css/layouts/layout-12.min.css',
                    'dark': 'assets/css/layouts/dark.min.css',
                    'rtl': 'assets/css/layouts/rtl.min.css',
                    'landing': 'assets/css/layouts/landing.min.css'
                };

                if (themeFiles[themeName]) {
                    this.loadCSS(themeFiles[themeName], 'theme-' + themeName);
                }
            },

            loadPageStyle: function (pageName) {
                const pageFiles = {
                    'pages': 'assets/css/pages/pages.min.css',
                    'gallery': 'assets/css/pages/gallery.min.css',
                    'team-overview': 'css/team-overview.min.css'
                };

                if (pageFiles[pageName]) {
                    this.loadCSS(pageFiles[pageName], 'page-' + pageName);
                }
            },

            loadCSS: function (href, id) {
                if (id && document.getElementById(id)) {
                    document.getElementById(id).remove();
                }

                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = href;
                if (id) link.id = id;

                // Use requestIdleCallback for non-critical CSS
                if ('requestIdleCallback' in window) {
                    requestIdleCallback(() => {
                        document.head.appendChild(link);
                    });
                } else {
                    setTimeout(() => {
                        document.head.appendChild(link);
                    }, 0);
                }
            },

            unloadTheme: function (themeName) {
                const themeElement = document.getElementById('theme-' + themeName);
                if (themeElement) {
                    themeElement.remove();
                }
            }
        };

        // Download file helper for Excel export/import
        window.downloadFile = function (filename, contentType, base64Data) {
            try {
                // Convert base64 to blob
                const byteCharacters = atob(base64Data);
                const byteNumbers = new Array(byteCharacters.length);
                for (let i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                const byteArray = new Uint8Array(byteNumbers);
                const blob = new Blob([byteArray], { type: contentType });

                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();

                // Cleanup
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
            } catch (error) {
                console.error('Error downloading file:', error);
                swal('Error', 'Failed to download file: ' + error.message, 'error');
            }
        };

        // Enhanced Script Loader for Blazor Components
        window.ComponentScriptLoader = {
            loadedScripts: new Set(),

            loadComponentScript: function (scriptName) {
                if (this.loadedScripts.has(scriptName)) {
                    return Promise.resolve();
                }

                const scriptFiles = {
                    'charts': 'js/statistics-charts.min.js',
                    'Vendor-charts': 'js/Vendor-statistics-charts.min.js',
                    'text-editor': 'js/text-editor.min.js',
                    'rich-text-editor': 'assets/js/rich-text-editor-helper.js',
                    'data-tables': 'assets/js/pages/data-basic-custom.min.js',
                    'data-source': 'assets/js/pages/data-source-custom.min.js',
                    'data-plugin': 'assets/js/pages/data-plugin-custom.min.js',
                    'statistics': 'assets/js/pages/statistic.min.js',
                    'notifications': 'assets/js/pages/ac-notification.min.js',
                    'widget-data': 'assets/js/pages/widget-data.min.js',
                    'team-overview': 'scripts/team-overview.min.js',
                    'grid-animation': 'assets/js/pages/grid-animation/main.min.js',
                    'daterangepicker': 'assets/js/plugins/daterangepicker.min.js',
                    'trumbowyg': 'assets/js/plugins/trumbowyg/trumbowyg.min.js',
                    'error-page': 'assets/js/pages/error.min.js'
                };

                if (!scriptFiles[scriptName]) {
                    return Promise.reject(new Error('Script not found: ' + scriptName));
                }

                return this.loadScript(scriptFiles[scriptName])
                    .then(() => {
                        this.loadedScripts.add(scriptName);
                    });
            },

            loadScript: function (src) {
                return new Promise((resolve, reject) => {
                    if (document.querySelector(`script[src="${src}"]`)) {
                        resolve();
                        return;
                    }

                    const script = document.createElement('script');
                    script.src = src;
                    script.async = true;
                    script.onload = resolve;
                    script.onerror = reject;
                    document.head.appendChild(script);
                });
            }
        };

        // Optimized initialization function with dependency checks
        function initializeCriticalFeatures() {
            // Ensure all dependencies are loaded before proceeding
            if (!checkjQueryLoaded()) {
                console.warn('jQuery not loaded yet, waiting...');
                waitForjQuery(initializeCriticalFeatures);
                return;
            }

            if (!checkLocalizationLoaded()) {
                console.warn('Localization not loaded yet, waiting...');
                waitForLocalization(initializeCriticalFeatures);
                return;
            }

            // Enhanced menu toggle for Blazor WebAssembly
            $(document).off('click.blazor-enhanced').on('click.blazor-enhanced', '#mobile-collapse, #mobile-collapse1, .mobile-menu', function (e) {
                e.preventDefault();
                e.stopPropagation();

                var vw = window.innerWidth || document.documentElement.clientWidth;

                if (vw < 992) {
                    var $navbar = $(".pcoded-navbar");
                    var isOpen = $navbar.hasClass('mob-open');

                    if (isOpen) {
                        $navbar.removeClass('mob-open');
                        $(this).removeClass('on');
                        $(".mobile-menu").removeClass('on');
                        $("#mobile-collapse, #mobile-collapse1").removeClass('on');
                    } else {
                        $navbar.addClass('mob-open');
                        $(this).addClass('on');
                        $(".mobile-menu").addClass('on');
                        $("#mobile-collapse, #mobile-collapse1").addClass('on');
                    }
                }
            });

            // Initialize responsive navbar
            var currentVw = window.innerWidth || document.documentElement.clientWidth;
            var $navbar = $(".pcoded-navbar");

            if (currentVw >= 992 && currentVw <= 1200) {
                $navbar.addClass('navbar-collapsed');
            } else if (currentVw >= 1200) {
                $navbar.removeClass('navbar-collapsed');
            }
        }

        // Initialize navigation helpers - with dependency checks
        window.initializePcodedMenu = function () {
            try {
                // Wait for all dependencies if not loaded
                if (!checkjQueryLoaded() || !checkLocalizationLoaded()) {
                    console.warn('Dependencies not available for pcoded menu initialization, waiting...');
                    waitForDependencies(() => {
                        window.initializePcodedMenu();
                    });
                    return;
                }

                if (typeof $.fn.pcodedmenu === 'function' && $("#pcoded").length > 0) {
                    $("#pcoded").pcodedmenu({
                        MenuTrigger: 'click',
                        SubMenuTrigger: 'click',
                    });
                }
            } catch (error) {
                console.error('Error initializing pcoded menu:', error);
            }
        };

        window.clearAllActiveStates = function () {
            if (!checkjQueryLoaded()) {
                console.warn('jQuery not available for clearing active states');
                return;
            }
            try {
                $(".pcoded-navbar .pcoded-inner-navbar li").removeClass("active");
                $(".pcoded-navbar .pcoded-inner-navbar .pcoded-hasmenu").removeClass("active pcoded-trigger");
                $(".pcoded-navbar .nav-link").blur();
            } catch (error) {
                console.error('Error clearing active states:', error);
            }
        };

        window.setActiveMenuItems = function () {
            if (!checkjQueryLoaded()) {
                console.warn('jQuery not available for setting active menu items');
                return;
            }
            try {
                var pageUrl = window.location.href.split(/[?#]/)[0];
                $(".pcoded-navbar .pcoded-inner-navbar a").each(function () {
                    if (this.href == pageUrl && $(this).attr('href') != "") {
                        $(this).parent('li').addClass("active");
                        if (!$('.pcoded-navbar').hasClass('theme-horizontal')) {
                            $(this).parent('li').parent().parent('.pcoded-hasmenu').addClass("active").addClass("pcoded-trigger");
                        }
                    }
                });
            } catch (error) {
                console.error('Error setting active menu items:', error);
            }
        };

        // Initialize Perfect Scrollbar when needed
        window.initializePerfectScrollbar = function (selector) {
            if (typeof PerfectScrollbar === 'undefined') return;
            try {
                var element = document.querySelector('.' + selector);
                if (element) {
                    new PerfectScrollbar('.' + selector, {
                        wheelSpeed: 0.5,
                        swipeEasing: 0,
                        suppressScrollX: true,
                        wheelPropagation: 1,
                        minScrollbarLength: 40,
                    });
                }
            } catch (error) {
                console.error('Error initializing perfect scrollbar:', error);
            }
        };

        // Navigation scrollbar initialization
        window.initializeNavScrollbar = function () {
            if ('requestIdleCallback' in window) {
                requestIdleCallback(() => {
                    if (document.querySelector('.navbar-content') && typeof PerfectScrollbar !== 'undefined') {
                        if (window.navScrollbar) {
                            window.navScrollbar.destroy();
                        }
                        window.navScrollbar = new PerfectScrollbar('.navbar-content', {
                            wheelSpeed: 0.5,
                            swipeEasing: 0,
                            suppressScrollX: true,
                        });
                    }
                });
            }
        };

        // Initialize navbar handler
        window.navbarHandler = {
            init: function () {
                var navbarCollapse = document.getElementById("navbarSupportedContent");
                if (!navbarCollapse) return;

                var navList = navbarCollapse.querySelector("ul.navbar-nav");
                if (!window.matchMedia("(max-width: 991.98px)").matches) {
                    navList.style.display = "";
                    return;
                }

                var isShown = navbarCollapse.classList.contains("show");
                if (navList) {
                    navList.style.display = isShown ? "" : "none";
                }
            }
        };

        // Notification system for Blazor components
        window.showNotification = function (type, message) {
            // Create notification container if it doesn't exist
            let container = document.getElementById('notification-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notification-container';
                container.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; max-width: 400px;';
                document.body.appendChild(container);
            }

            // Create notification element
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : type === 'warning' ? '#f59e0b' : '#3b82f6';
            const icon = type === 'success' ? '‚úì' : type === 'error' ? '‚úï' : type === 'warning' ? '‚ö†' : '‚Ñπ';

            notification.style.cssText = `
                margin-bottom: 10px;
                padding: 16px 20px;
                background-color: ${bgColor};
                color: white;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                display: flex;
                align-items: center;
                gap: 12px;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                font-size: 14px;
                font-weight: 500;
                animation: slideInRight 0.3s ease-out;
            `;

            notification.innerHTML = `<span style="font-size: 18px; font-weight: bold;">${icon}</span><span>${message}</span>`;
            container.appendChild(notification);

            // Auto-remove notification after 4 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 4000);
        };

        // Add CSS animations for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    opacity: 0;
                    transform: translateX(100%);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }

            @keyframes slideOutRight {
                from {
                    opacity: 1;
                    transform: translateX(0);
                }
                to {
                    opacity: 0;
                    transform: translateX(100%);
                }
            }
        `;
        document.head.appendChild(style);
    </script>

    <style>
         /* Additional performance optimizations */
         .pcoded-navbar .nav-link:focus,
         .pcoded-navbar .nav-link:focus-visible {
             outline: none !important;
             box-shadow: none !important;
         }

         /* Optimize rendering performance */
         .loading-container,
         .loading-logo-img {
             contain: layout style paint;
             will-change: transform, opacity;
         }

         /* Prevent layout shifts */
         img {
             height: auto;
             max-width: 100%;
         }

         /* Optimize font rendering */
         body {
             -webkit-font-smoothing: antialiased;
             -moz-osx-font-smoothing: grayscale;
             text-rendering: optimizeLegibility;
         }

         /* MOBILE HEADER - ICONS ON SAME LINE AS LOGO */
         @media (max-width: 991.98px) {
             .pcoded-header {
                 min-height: 56px !important;
                 height: 56px !important;
                 padding: 0 !important;
             }

                 .pcoded-header .m-header {
                     display: flex !important;
                     align-items: center !important;
                     justify-content: space-between !important;
                     height: 56px !important;
                     padding: 0 0.75rem !important;
                     width: 100% !important;
                 }

                     .pcoded-header .m-header .b-brand {
                         padding: 0 !important;
                         display: flex !important;
                         align-items: center !important;
                     }

                         .pcoded-header .m-header .b-brand img {
                             max-height: 50px !important;
                         }

                 .pcoded-header .mobile-menu {
                     width: 32px !important;
                     height: 32px !important;
                     margin-right: 0.5rem !important;
                 }

                 .pcoded-header .m-header > div:last-child {
                     display: flex !important;
                     align-items: center !important;
                     gap: 0.25rem !important;
                 }

                 .pcoded-header .m-header .navbar-nav {
                     display: flex !important;
                     flex-direction: row !important;
                     align-items: center !important;
                     gap: 0.25rem !important;
                     margin: 0 35px !important;
                     padding: 0 !important;
                     list-style: none !important;
                 }

                     .pcoded-header .m-header .navbar-nav > li {
                         display: flex !important;
                         align-items: center !important;
                         margin: 35px 0 !important;
                         padding: 0 !important;
                     }

                         .pcoded-header .m-header .navbar-nav > li > a,
                         .pcoded-header .m-header .navbar-nav > li > button,
                         .pcoded-header .m-header .navbar-nav .dropdown-toggle {
                             display: flex !important;
                             align-items: center !important;
                             justify-content: center !important;
                             width: 36px !important;
                             height: 36px !important;
                             padding: 0 !important;
                             background: transparent !important;
                             border: none !important;
                             margin: 0 !important;
                             text-decoration: none !important;
                         }

                             .pcoded-header .m-header .navbar-nav > li > a:hover,
                             .pcoded-header .m-header .navbar-nav > li > button:hover,
                             .pcoded-header .m-header .navbar-nav .dropdown-toggle:hover {
                                 background: rgba(255, 255, 255, 0.1) !important;
                                 border-radius: 0.25rem !important;
                             }

                     .pcoded-header .m-header .navbar-nav i,
                     .pcoded-header .m-header .navbar-nav .feather {
                         display: block !important;
                         font-size: 1.1rem !important;
                         color: #fff !important;
                         margin: 0 !important;
                     }

                     .pcoded-header .m-header .navbar-nav .dropdown-menu {
                         position: absolute !important;
                         right: 0 !important;
                         left: auto !important;
                         top: 100% !important;
                         margin-top: 0.5rem !important;
                     }

                     .pcoded-header .m-header .navbar-nav .dropdown .notification {
                         right: 50% !important;
                         top: calc(100% + 0.5rem) !important;
                         transform: translateX(50%);
                     }

                 .pcoded-header #navbarSupportedContent {
                     display: none !important;
                 }
         }

         @media (min-width: 992px) {
             .pcoded-header {
                 display: flex;
                 align-items: center;
                 min-height: 56px;
             }

                 .pcoded-header .m-header {
                     display: flex;
                     align-items: center;
                 }

                     .pcoded-header .m-header > div:last-child {
                         display: none !important;
                     }

                 .pcoded-header #navbarSupportedContent {
                     display: flex !important;
                 }

                 .pcoded-header .navbar-nav {
                     display: flex;
                     align-items: center;
                 }

                     .pcoded-header .navbar-nav > li {
                         display: flex;
                         align-items: center;
                         height: 56px;
                     }

                         .pcoded-header .navbar-nav > li > a,
                         .pcoded-header .navbar-nav > li > button {
                             display: flex;
                             align-items: center;
                             height: 100%;
                         }

             #b-brand {
                 display: none;
             }

             #mobile-collapse1 {
                 display: none !important;
             }
         }

         /* MOBILE HEADER FIX - SHOW ICONS */
         @media (max-width: 991.98px) {
             .pcoded-header .m-header > div:last-child {
                 display: flex !important;
                 align-items: center !important;
                 gap: 8px !important;
             }

             .pcoded-header .m-header .navbar-nav {
                 display: flex !important;
                 flex-direction: row !important;
                 align-items: center !important;
                 gap: 8px !important;
                 margin: 0 !important;
                 padding: 0 !important;
             }

                 .pcoded-header .m-header .navbar-nav > li {
                     display: flex !important;
                     align-items: center !important;
                     margin: 0 !important;
                 }

                     .pcoded-header .m-header .navbar-nav > li > a,
                     .pcoded-header .m-header .navbar-nav > li > button {
                         display: flex !important;
                         align-items: center !important;
                         justify-content: center !important;
                         width: 40px !important;
                         height: 40px !important;
                         padding: 0 !important;
                         color: var(--neutral-dark) !important;
                         background: transparent !important;
                         border: none !important;
                         border-radius: var(--radius-sm) !important;
                         transition: var(--transition-fast);
                     }

                         .pcoded-header .m-header .navbar-nav > li > a:hover,
                         .pcoded-header .m-header .navbar-nav > li > button:hover {
                             background: var(--neutral-lighter) !important;
                             color: var(--primary) !important;
                         }

                 .pcoded-header .m-header .navbar-nav i,
                 .pcoded-header .m-header .navbar-nav .feather {
                     font-size: 20px !important;
                     color: inherit !important;
                 }

             .pcoded-header .m-header .dropdown-toggle {
                 width: auto !important;
                 padding: 8px 12px !important;
                 border: 1.5px solid var(--neutral-light) !important;
                 border-radius: var(--radius-sm) !important;
                 color: var(--neutral-dark) !important;
                 font-size: 14px !important;
             }
         }

         /* ========================================
        üé® BASYIT GREEN THEME - LOADING SCREEN
        ======================================== */
         .loading-container {
             background: linear-gradient(135deg, #0d5449 0%, #094038 100%) !important;
         }

         .loading-logo-img {
             filter: drop-shadow(0 4px 12px rgba(255, 255, 255, 0.3));
         }

         .loading-text {
             color: #FFFFFF !important;
             font-family: 'Cairo', 'Tajawal', sans-serif !important;
             text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
         }

         .loading-subtitle {
             color: rgba(255, 255, 255, 0.9) !important;
         }

         .progress-container {
             background: rgba(255, 255, 255, 0.2) !important;
         }

         .progress-bar {
             background: #FFFFFF !important;
             box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
         }

         .loading-tip {
             color: rgba(255, 255, 255, 0.85) !important;
             font-size: 13px;
             margin-top: 10px;
         }

         /* ========================================
        üé® BASYIT GREEN THEME - HEADER
        ======================================== */
         .pcoded-header {
             background: #FFFFFF !important;
             box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08) !important;
             border-bottom: 1px solid #E2E8F0 !important;
         }

             .pcoded-header .navbar-nav > li > a,
             .pcoded-header .navbar-nav > li > button,
             .pcoded-header .dropdown-toggle {
                 color: #334155 !important;
             }

                 .pcoded-header .navbar-nav > li > a:hover,
                 .pcoded-header .navbar-nav > li > button:hover,
                 .pcoded-header .dropdown-toggle:hover {
                     color: #0d5449 !important;
                     background: #e8f5f3 !important;
                 }

             .pcoded-header .dropdown-toggle {
                 border: 1.5px solid #E2E8F0 !important;
                 background: transparent !important;
             }

                 .pcoded-header .dropdown-toggle:hover {
                     border-color: #0d5449 !important;
                     background: #e8f5f3 !important;
                 }

         .mobile-menu,
         #mobile-collapse,
         #mobile-collapse1 {
             color: #334155 !important;
         }

             .mobile-menu:hover,
             #mobile-collapse:hover,
             #mobile-collapse1:hover {
                 color: #0d5449 !important;
                 background: #e8f5f3 !important;
             }

         /* Error message styling */
         .error-message {
             color: #FFFFFF !important;
             background: rgba(239, 68, 68, 0.2) !important;
             padding: 12px 20px;
             border-radius: 6px;
             margin-top: 16px;
             border: 1px solid rgba(239, 68, 68, 0.3);
         }
    </style>
</body>
</html>