(function(n){"use strict";function pe(){ti.add("link",function(n){y.setupButtons(n);y.setupMenuItems(n);y.setupContextMenu(n);y.setupContextToolbars(n);u.setupGotoLinks(n);se.register(n);ce.setup(n)})}var ti=tinymce.util.Tools.resolve("tinymce.PluginManager"),ii=tinymce.util.Tools.resolve("tinymce.util.VK"),ri=function(n){if(n===null)return"null";var t=typeof n;return t==="object"&&(Array.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="String")?"string":t},l=function(n){return function(t){return ri(t)===n}},h=l("string"),rt=l("array"),ui=l("boolean"),ut=l("function"),fi=function(n){var t=n.getParam("link_assume_external_targets",!1);return ui(t)&&t?1:h(t)&&(t==="http"||t==="https")?t:0},ei=function(n){return n.getParam("link_context_toolbar",!1,"boolean")},oi=function(n){return n.getParam("link_list")},si=function(n){return n.getParam("default_link_target")},hi=function(n){return n.getParam("target_list",!0)},ci=function(n){return n.getParam("rel_list",[],"array")},li=function(n){return n.getParam("link_class_list",[],"array")},ai=function(n){return n.getParam("link_title",!0,"boolean")},vi=function(n){return n.getParam("allow_unsafe_link_target",!1,"boolean")},yi=function(n){return n.getParam("link_quicklink",!1,"boolean")},pi=function(n){return n.getParam("link_default_protocol","http","string")},r={assumeExternalTargets:fi,hasContextToolbar:ei,getLinkList:oi,getDefaultLinkTarget:si,getTargetList:hi,getRelList:ci,getLinkClassList:li,shouldShowLinkTitle:ai,allowUnsafeLinkTarget:vi,useQuickLink:yi,getDefaultLinkProtocol:pi},wi=function(t,i){n.document.body.appendChild(t);t.dispatchEvent(i);n.document.body.removeChild(t)},bi=function(t){var i=n.document.createElement("a"),r;i.target="_blank";i.href=t;i.rel="noreferrer noopener";r=n.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.window,0,0,0,0,0,!1,!1,!1,!1,0,null);wi(i,r)},ki={open:bi},e=function(){return e=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},e.apply(this,arguments)},ft=function(){},o=function(n){return function(){return n}},c=o(!1),p=o(!0),a=function(){return w},w=function(){var n=function(n){return n.isNone()},t=function(n){return n()},i=function(n){return n},r={fold:function(n){return n()},is:c,isSome:c,isNone:p,getOr:i,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.");},getOrNull:o(null),getOrUndefined:o(undefined),or:i,orThunk:t,map:a,each:ft,bind:a,exists:c,forall:p,filter:a,equals:n,equals_:n,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(r),r}(),b=function(n){var t=o(n),u=function(){return r},i=function(t){return t(n)},r={fold:function(t,i){return i(n)},is:function(t){return n===t},isSome:p,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:u,orThunk:u,map:function(t){return b(t(n))},each:function(t){t(n)},bind:i,exists:i,forall:i,filter:function(t){return t(n)?r:w},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,i){return t.fold(c,function(t){return i(n,t)})}};return r},di=function(n){return n===null||n===undefined?w:b(n)},t={some:b,none:a,from:di},gi=Array.prototype.slice,nr=Array.prototype.indexOf,tr=Array.prototype.push,ir=function(n,t){return nr.call(n,t)},rr=function(n,t){return ir(n,t)>-1},ur=function(n,t){for(var f,r=n.length,u=new Array(r),i=0;i<r;i++)f=n[i],u[i]=t(f,i);return u},et=function(n,t){for(var u,i=0,r=n.length;i<r;i++)u=n[i],t(u,i)},fr=function(n,t,i){return et(n,function(n){i=t(i,n)}),i},ot=function(n){for(var i=[],t=0,r=n.length;t<r;++t){if(!rt(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);tr.apply(i,n[t])}return i},er=function(n,t){return ot(ur(n,t))},we=ut(Array.from)?Array.from:function(n){return gi.call(n)},st=function(n,i){for(var u,r=0;r<n.length;r++)if(u=i(n[r],r),u.isSome())return u;return t.none()},v=tinymce.util.Tools.resolve("tinymce.util.Tools"),ht=function(n){return/^\w+:/i.test(n)},or=function(n){var t=n.getAttribute("data-mce-href");return t?t:n.getAttribute("href")},ct=function(n,t){var i=["noopener"],r=n?n.split(/\s+/):[],e=function(n){return v.trim(n.sort().join(" "))},o=function(n){return n=u(n),n.length>0?n.concat(i):i},u=function(n){return n.filter(function(n){return v.inArray(i,n)===-1})},f=t?o(r):u(r);return f.length>0?e(f):""},sr=function(n){return n.replace(/\uFEFF/g,"")},lt=function(n,t){return t=t||n.selection.getNode(),k(t)?n.dom.select("a[href]",t)[0]:n.dom.getParent(t,"a[href]")},hr=function(n,t){var i=t?t.innerText||t.textContent:n.getContent({format:"text"});return sr(i)},at=function(n){return n&&n.nodeName==="A"&&!!n.href},cr=function(n){return v.grep(n,at).length>0},lr=function(n){return/</.test(n)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(n)||n.indexOf("href=")===-1)?!1:!0},k=function(n){return n&&n.nodeName==="FIGURE"&&/\bimage\b/i.test(n.className)},ar=function(n){return fr(["title","rel","class","target"],function(t,i){return n[i].each(function(n){t[i]=n.length>0?n:null}),t},{href:n.href})},vr=function(n,t){return(t==="http"||t==="https")&&!ht(n)?t+"://"+n:n},yr=function(n,i){var u=e({},i),f;return r.getRelList(n).length>0||r.allowUnsafeLinkTarget(n)!==!1||(f=ct(u.rel,u.target==="_blank"),u.rel=f?f:null),t.from(u.target).isNone()&&r.getTargetList(n)===!1&&(u.target=r.getDefaultLinkTarget(n)),u.href=vr(u.href,r.assumeExternalTargets(n)),u},pr=function(n,t,i,r){i.each(function(n){t.hasOwnProperty("innerText")?t.innerText=n:t.textContent=n});n.dom.setAttribs(t,r);n.selection.select(t)},wr=function(n,t,i,r){k(t)?gr(n,t,r):i.fold(function(){n.execCommand("mceInsertLink",!1,r)},function(t){n.insertContent(n.dom.createHTML("a",r,n.dom.encode(t)))})},br=function(n,t,i){var r=n.selection.getNode(),u=lt(n,r),f=yr(n,ar(i));n.undoManager.transact(function(){i.href===t.href&&t.attach();u?(n.focus(),pr(n,u,i.text,f)):wr(n,r,i.text,f)})},kr=function(n){n.undoManager.transact(function(){var t=n.selection.getNode(),i;k(t)?dr(n,t):(i=n.dom.getParent(t,"a[href]",n.getBody()),i&&n.dom.remove(i,!0));n.focus()})},dr=function(n,t){var r=n.dom.select("img",t)[0],i;r&&(i=n.dom.getParents(r,"a[href]",t)[0],i&&(i.parentNode.insertBefore(r,i),n.dom.remove(i)))},gr=function(n,t,i){var r=n.dom.select("img",t)[0],u;r&&(u=n.dom.create("a",i),r.parentNode.insertBefore(u,r),u.appendChild(r))},i={link:br,unlink:kr,isLink:at,hasLinks:cr,getHref:or,isOnlyTextSelected:lr,getAnchorElement:lt,getAnchorText:hr,applyRelTargetRules:ct,hasProtocol:ht},nu=function(n){for(var i=[],r=function(n){i.push(n)},t=0;t<n.length;t++)n[t].each(r);return i},d=function(n){return h(n.value)?n.value:""},tu=function(n,t){var i=[];return v.each(n,function(n){var u=h(n.text)?n.text:h(n.title)?n.title:"",r;n.menu!==undefined||(r=t(n),i.push({text:u,value:r}))}),i},vt=function(n){return n===void 0&&(n=d),function(i){return t.from(i).map(function(t){return tu(t,n)})}},iu=function(n){return vt(d)(n)},ru=function(n,t){return function(i){return{name:n,type:"selectbox",label:t,items:i}}},f={sanitize:iu,sanitizeWith:vt,createUi:ru,getValue:d},yt=function(n){var t=n,i=function(){return t},r=function(n){t=n},u=function(){return yt(i())};return{get:i,set:r,clone:u}},uu=function(n,i){return st(i,function(i){return t.some(i).filter(function(t){return t.value===n})})},pt=function(n,i,r,u){var f=u[i],e=n.length>0;return f!==undefined?uu(f,r).map(function(t){return{url:{value:t.value,meta:{text:e?n:t.text,attach:ft}},text:e?n:t.text}}):t.none()},fu=function(n,i){return i==="link"?n.catalogs.link:i==="anchor"?n.catalogs.anchor:t.none()},eu=function(n,i){var r=yt(n.text),u=function(n){if(r.get().length<=0){var i=n.url.meta.text!==undefined?n.url.meta.text:n.url.value,u=n.url.meta.title!==undefined?n.url.meta.title:"";return t.some({text:i,title:u})}return t.none()},f=function(n,t){var u=fu(i,t.name).getOr([]);return pt(r.get(),t.name,u,n)},e=function(n,i){return i.name==="url"?u(n()):rr(["anchor","link"],i.name)?f(n(),i):i.name==="text"?(r.set(n().text),t.none()):t.none()};return{onChange:e}},ou={init:eu,getDelta:pt},wt={},bt={exports:wt};(function(n,t,i,r){(function(r){if(typeof t=="object"&&typeof i!="undefined")i.exports=r();else if(typeof n=="function"&&n.amd)n([],r);else{var u;u=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;u.EphoxContactWrapper=r()}})(function(){return function(){function n(t,i,u){function f(e,s){var c,l,h;if(!i[e]){if(!t[e]){if(c="function"==typeof r&&r,!s&&c)return c(e,!0);if(o)return o(e,!0);l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l;}h=i[e]={exports:{}};t[e][0].call(h.exports,function(n){var i=t[e][1][n];return f(i||n)},h,h.exports,n,t,i,u)}return i[e].exports}for(var o="function"==typeof r&&r,e=0;e<u.length;e++)f(u[e]);return f}return n}()({1:[function(n,t){function c(){throw new Error("setTimeout has not been defined");}function l(){throw new Error("clearTimeout has not been defined");}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===c||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}function p(n){if(u===clearTimeout)return clearTimeout(n);if((u===l||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(n);try{return u(n)}catch(t){try{return u.call(null,n)}catch(t){return u.call(this,n)}}}function w(){s&&o&&(s=!1,o.length?f=o.concat(f):h=-1,f.length&&v())}function v(){var t,n;if(!s){for(t=a(w),s=!0,n=f.length;n;){for(o=f,f=[];++h<n;)o&&o[h].run();h=-1;n=f.length}o=null;s=!1;p(t)}}function y(n,t){this.fun=n;this.array=t}function e(){}var i=t.exports={},r,u;(function(){try{r=typeof setTimeout=="function"?setTimeout:c}catch(n){r=c}try{u=typeof clearTimeout=="function"?clearTimeout:l}catch(n){u=l}})();var f=[],s=!1,o,h=-1;i.nextTick=function(n){var i=new Array(arguments.length-1),t;if(arguments.length>1)for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];f.push(new y(n,i));f.length!==1||s||a(v)};y.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};i.on=e;i.addListener=e;i.once=e;i.off=e;i.removeListener=e;i.removeAllListeners=e;i.emit=e;i.prependListener=e;i.prependOnceListener=e;i.listeners=function(){return[]};i.binding=function(){throw new Error("process.binding is not supported");};i.cwd=function(){return"/"};i.chdir=function(){throw new Error("process.chdir is not supported");};i.umask=function(){return 0}},{}],2:[function(n,t){(function(n){(function(i){function c(){}function l(n,t){return function(){n.apply(t,arguments)}}function r(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];s(n,this)}function o(n,t){while(n._state===3)n=n._value;if(n._state===0){n._deferreds.push(t);return}n._handled=!0;r._immediateFn(function(){var i=n._state===1?t.onFulfilled:t.onRejected,r;if(i===null){(n._state===1?f:u)(t.promise,n._value);return}try{r=i(n._value)}catch(e){u(t.promise,e);return}f(t.promise,r)})}function f(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(typeof t=="object"||typeof t=="function")){var i=t.then;if(t instanceof r){n._state=3;n._value=t;e(n);return}if(typeof i=="function"){s(l(i,t),n);return}}n._state=1;n._value=t;e(n)}catch(f){u(n,f)}}function u(n,t){n._state=2;n._value=t;e(n)}function e(n){n._state===2&&n._deferreds.length===0&&r._immediateFn(function(){n._handled||r._unhandledRejectionFn(n._value)});for(var t=0,i=n._deferreds.length;t<i;t++)o(n,n._deferreds[t]);n._deferreds=null}function a(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function s(n,t){var i=!1;try{n(function(n){i||(i=!0,f(t,n))},function(n){i||(i=!0,u(t,n))})}catch(r){if(i)return;i=!0;u(t,r)}}var h=setTimeout;r.prototype["catch"]=function(n){return this.then(null,n)};r.prototype.then=function(n,t){var i=new this.constructor(c);return o(this,new a(n,t,i)),i};r.all=function(n){var t=Array.prototype.slice.call(n);return new r(function(n,i){function f(r,e){try{if(e&&(typeof e=="object"||typeof e=="function")){var o=e.then;if(typeof o=="function"){o.call(e,function(n){f(r,n)},i);return}}t[r]=e;--u==0&&n(t)}catch(s){i(s)}}var u,r;if(t.length===0)return n([]);for(u=t.length,r=0;r<t.length;r++)f(r,t[r])})};r.resolve=function(n){return n&&typeof n=="object"&&n.constructor===r?n:new r(function(t){t(n)})};r.reject=function(n){return new r(function(t,i){i(n)})};r.race=function(n){return new r(function(t,i){for(var r=0,u=n.length;r<u;r++)n[r].then(t,i)})};r._immediateFn=typeof n=="function"?function(t){n(t)}:function(n){h(n,0)};r._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};r._setImmediateFn=function(n){r._immediateFn=n};r._setUnhandledRejectionFn=function(n){r._unhandledRejectionFn=n};typeof t!="undefined"&&t.exports?t.exports=r:i.Promise||(i.Promise=r)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,i){(function(t,r){function u(n,t){this._id=n;this._clearFn=t}var o=n("process/browser.js").nextTick,e=Function.prototype.apply,s=Array.prototype.slice,f={},h=0;i.setTimeout=function(){return new u(e.call(setTimeout,window,arguments),clearTimeout)};i.setInterval=function(){return new u(e.call(setInterval,window,arguments),clearInterval)};i.clearTimeout=i.clearInterval=function(n){n.close()};u.prototype.unref=u.prototype.ref=function(){};u.prototype.close=function(){this._clearFn.call(window,this._id)};i.enroll=function(n,t){clearTimeout(n._idleTimeoutId);n._idleTimeout=t};i.unenroll=function(n){clearTimeout(n._idleTimeoutId);n._idleTimeout=-1};i._unrefActive=i.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))};i.setImmediate=typeof t=="function"?t:function(n){var t=h++,r=arguments.length<2?!1:s.call(arguments,1);return f[t]=!0,o(function(){f[t]&&(r?n.apply(null,r):n.call(null),i.clearImmediate(t))}),t};i.clearImmediate=typeof r=="function"?r:function(n){delete f[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t){var i=n("promise-polyfill"),r=function(){return typeof window!="undefined"?window:Function("return this;")()}();t.exports={boltExport:r.Promise||i}},{"promise-polyfill":2}]},{},[4])(4)})})(undefined,wt,bt,undefined);var kt=bt.exports.boltExport,g=function(i){var r=t.none(),u=[],s=function(n){return g(function(t){f(function(i){t(n(i))})})},f=function(n){e()?o(n):u.push(n)},h=function(n){r=t.some(n);c(u);u=[]},e=function(){return r.isSome()},c=function(n){et(n,o)},o=function(t){r.each(function(i){n.setTimeout(function(){t(i)},0)})};return i(h),{get:f,map:s,isReady:e}},su=function(n){return g(function(t){t(n)})},hu={nu:g,pure:su},cu=function(t){n.setTimeout(function(){throw t;},0)},s=function(n){var t=function(t){n().then(t,cu)},i=function(t){return s(function(){return n().then(t)})},r=function(t){return s(function(){return n().then(function(n){return t(n).toPromise()})})},u=function(t){return s(function(){return n().then(function(){return t.toPromise()})})},f=function(){return hu.nu(t)},e=function(){var t=null;return s(function(){return t===null&&(t=n()),t})},o=n;return{map:i,bind:r,anonBind:u,toLazy:f,toCached:e,toPromise:o,get:t}},lu=function(n){return s(function(){return new kt(n)})},au=function(n){return s(function(){return kt.resolve(n)})},nt={nu:lu,pure:au},vu=tinymce.util.Tools.resolve("tinymce.util.Delay"),yu=function(n,t,i){var r=n.selection.getRng();vu.setEditorTimeout(n,function(){n.windowManager.confirm(t,function(t){n.selection.setRng(r);i(t)})})},pu=function(n){var i=n.href,r=i.indexOf("@")>0&&i.indexOf("//")===-1&&i.indexOf("mailto:")===-1;return r?t.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(n){return e(e({},n),{href:"mailto:"+i})}}):t.none()},wu=function(n,r){return function(u){var f=u.href,o=n===1&&!i.hasProtocol(f)||n===0&&/^\s*www[\.|\d\.]/i.test(f);return o?t.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(n){return e(e({},n),{href:r+"://"+f})}}):t.none()}},bu=function(n,t){return st([pu,wu(r.assumeExternalTargets(n),r.getDefaultLinkProtocol(n))],function(n){return n(t)}).fold(function(){return nt.pure(t)},function(i){return nt.nu(function(r){yu(n,i.message,function(n){r(n?i.preprocess(t):t)})})})},ku={preprocess:bu},du=function(n){var r=n.dom.select("a:not([href])"),i=er(r,function(n){var t=n.name||n.id;return t?[{text:t,value:"#"+t}]:[]});return i.length>0?t.some([{text:"None",value:""}].concat(i)):t.none()},gu={getAnchors:du},nf=function(n){var i=r.getLinkClassList(n);return i.length>0?f.sanitize(i):t.none()},tf={getClasses:nf},rf=tinymce.util.Tools.resolve("tinymce.util.XHR"),uf=function(n){try{return t.some(JSON.parse(n))}catch(i){return t.none()}},ff=function(n){var u=function(t){return n.convertURL(t.value||t.url,"href")},i=r.getLinkList(n);return nt.nu(function(n){h(i)?rf.send({url:i,success:function(t){return n(uf(t))},error:function(){return n(t.none())}}):ut(i)?i(function(i){return n(t.some(i))}):n(t.from(i))}).map(function(n){return n.bind(f.sanitizeWith(u)).map(function(n){return n.length>0?[{text:"None",value:""}].concat(n):n})})},ef={getLinks:ff},sf=function(n,u){var e=r.getRelList(n);if(e.length>0){var o=u.is("_blank"),s=r.allowUnsafeLinkTarget(n)===!1,h=function(n){return i.applyRelTargetRules(f.getValue(n),o)},c=s?f.sanitizeWith(h):f.sanitize;return c(e)}return t.none()},hf={getRels:sf},dt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],cf=function(n){var i=r.getTargetList(n);return rt(i)?f.sanitize(i).orThunk(function(){return t.some(dt)}):i===!1?t.none():t.some(dt)},lf={getTargets:cf},tt=function(n,i,r){var u=n.getAttrib(i,r);return u!==null&&u.length>0?t.some(u):t.none()},af=function(n,r){var u=n.dom,f=i.isOnlyTextSelected(n.selection.getContent()),e=f?t.some(i.getAnchorText(n.selection,r)):t.none(),o=r?t.some(u.getAttrib(r,"href")):t.none(),s=r?t.from(u.getAttrib(r,"target")):t.none(),h=tt(u,r,"rel"),c=tt(u,r,"class"),l=tt(u,r,"title");return{url:o,text:e,title:l,target:s,rel:h,linkClass:c}},vf=function(n,i){return ef.getLinks(n).map(function(u){var f=af(n,i);return{anchor:f,catalogs:{targets:lf.getTargets(n),rels:hf.getRels(n,f.target),classes:tf.getClasses(n),anchor:gu.getAnchors(n),link:u},optNode:t.from(i),flags:{titleEnabled:r.shouldShowLinkTitle(n)}}})},yf={collect:vf},pf=function(n,r){return function(u){var f=u.getData();if(!f.url.value){i.unlink(n);u.close();return}var e=function(n){return t.from(f[n]).filter(function(t){return!r.anchor[n].is(t)})},o={href:f.url.value,text:e("text"),target:e("target"),rel:e("rel"),"class":e("linkClass"),title:e("title")},s={href:f.url.value,attach:f.url.meta!==undefined&&f.url.meta.attach?f.url.meta.attach:function(){}};ku.preprocess(n,o).get(function(t){i.link(n,s,t)});u.close()}},wf=function(n){var t=i.getAnchorElement(n);return yf.collect(n,t)},bf=function(n,t){return{url:{value:n.anchor.url.getOr(""),meta:{attach:function(){},text:n.anchor.url.fold(function(){return""},function(){return n.anchor.text.getOr("")}),original:{value:n.anchor.url.getOr("")}}},text:n.anchor.text.getOr(""),title:n.anchor.title.getOr(""),anchor:n.anchor.url.getOr(""),link:n.anchor.url.getOr(""),rel:n.anchor.rel.getOr(""),target:n.anchor.target.or(t).getOr(""),linkClass:n.anchor.linkClass.getOr("")}},kf=function(n,i,u){var s=n.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),h=n.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],c=t.from(r.getDefaultLinkTarget(u)),o=bf(n,c),l=ou.init(o,n),e=n.catalogs,a={type:"panel",items:ot([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],s,h,nu([e.anchor.map(f.createUi("anchor","Anchors")),e.rels.map(f.createUi("rel","Rel")),e.targets.map(f.createUi("target","Open link in...")),e.link.map(f.createUi("link","Link list")),e.classes.map(f.createUi("linkClass","Class"))])])};return{title:"Insert/Edit Link",size:"normal",body:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onChange:function(n,t){var i=t.name;l.onChange(n.getData,{name:i}).each(function(t){n.setData(t)})},onSubmit:i}},df=function(n){var t=wf(n);t.map(function(t){var i=pf(n,t);return kf(t,i,n)}).get(function(t){n.windowManager.open(t)})},gf={open:df},gt=function(n,t){return n.dom.getParent(t,"a[href]")},ni=function(n){return gt(n,n.selection.getStart())},ne=function(n){return n.altKey===!0&&n.shiftKey===!1&&n.ctrlKey===!1&&n.metaKey===!1},it=function(n,t){var r,u;t&&(r=i.getHref(t),/^#/.test(r)?(u=n.$(r),u.length&&n.selection.scrollIntoView(u[0],!0)):ki.open(t.href))},te=function(n){return function(){gf.open(n)}},ie=function(n){return function(){it(n,ni(n))}},re=function(n){return function(t){var f,u,e;return r.hasContextToolbar(n)&&i.isLink(t)&&(f=n.selection,u=f.getRng(),e=u.startContainer,e.nodeType===3&&f.isCollapsed()&&u.startOffset>0&&u.startOffset<e.data.length)?!0:!1}},ue=function(n){n.on("click",function(t){var i=gt(n,t.target);i&&ii.metaKeyPressed(t)&&(t.preventDefault(),it(n,i))});n.on("keydown",function(t){var i=ni(n);i&&t.keyCode===13&&ne(t)&&(t.preventDefault(),it(n,i))})},fe=function(n){return function(t){var r=function(r){return t.setActive(!n.readonly&&!!i.getAnchorElement(n,r.element))};n.on("NodeChange",r);return function(){return n.off("NodeChange",r)}}},ee=function(n){return function(t){t.setDisabled(!i.hasLinks(n.dom.getParents(n.selection.getStart())));var r=function(n){return t.setDisabled(!i.hasLinks(n.parents))};n.on("NodeChange",r);return function(){return n.off("NodeChange",r)}}},u={openDialog:te,gotoSelectedLink:ie,leftClickedOnAHref:re,setupGotoLinks:ue,toggleActiveState:fe,toggleEnabledState:ee},oe=function(n){n.addCommand("mceLink",function(){r.useQuickLink(n)?n.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):u.openDialog(n)()})},se={register:oe},he=function(n){n.addShortcut("Meta+K","",function(){n.execCommand("mceLink")})},ce={setup:he},le=function(n){n.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:u.openDialog(n),onSetup:u.toggleActiveState(n)});n.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:u.gotoSelectedLink(n),onSetup:u.toggleEnabledState(n)});n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return i.unlink(n)},onSetup:u.toggleEnabledState(n)})},ae=function(n){n.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:u.gotoSelectedLink(n),onSetup:u.toggleEnabledState(n)});n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:u.openDialog(n)});n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return i.unlink(n)},onSetup:u.toggleEnabledState(n)})},ve=function(n){var t="link unlink openlink",r="link";n.ui.registry.addContextMenu("link",{update:function(u){return i.hasLinks(n.dom.getParents(u,"a"))?t:r}})},ye=function(n){var e=function(n){n.selection.collapse(!1)},f=function(t){var r=n.selection.getNode();return t.setDisabled(!i.getAnchorElement(n,r)),function(){}};n.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:u.toggleActiveState(n)},label:"Link",predicate:function(t){return!!i.getAnchorElement(n,t)&&r.hasContextToolbar(n)},initValue:function(){var t=i.getAnchorElement(n);return!t?"":i.getHref(t)},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var r=n.selection.getNode();return t.setActive(!!i.getAnchorElement(n,r)),u.toggleActiveState(n)(t)},onAction:function(r){var f=i.getAnchorElement(n),u=r.getValue();if(f)n.dom.setAttrib(f,"href",u),e(n),r.hide();else{var o={href:u,attach:function(){}},s=i.isOnlyTextSelected(n.selection.getContent()),h=s?t.some(i.getAnchorText(n.selection,f)).filter(function(n){return n.length>0}).or(t.from(u)):t.none();i.link(n,o,{href:u,text:h,title:t.none(),rel:t.none(),target:t.none(),"class":t.none()});r.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:f,onAction:function(t){i.unlink(n);t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:f,onAction:function(t){u.gotoSelectedLink(n)();t.hide()}}]})},y={setupButtons:le,setupMenuItems:ae,setupContextMenu:ve,setupContextToolbars:ye};pe()})(window);