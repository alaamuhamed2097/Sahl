(function(n){"use strict";function cv(){bf.add("lists",function(n){return ev.setup(n),hv.register(n),rv.register(n),tv.get(n)})}var bf=tinymce.util.Tools.resolve("tinymce.PluginManager"),kf=function(){},i=function(n){return function(){return n}},di=function(n){return function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return!n.apply(null,i)}},w=i(!1),yt=i(!0),tt=function(){return pt},pt=function(){var n=function(n){return n.isNone()},t=function(n){return n()},r=function(n){return n},u={fold:function(n){return n()},is:w,isSome:w,isNone:yt,getOr:r,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.");},getOrNull:i(null),getOrUndefined:i(undefined),or:r,orThunk:t,map:tt,each:kf,bind:tt,exists:w,forall:yt,filter:tt,equals:n,equals_:n,toArray:function(){return[]},toString:i("none()")};return Object.freeze&&Object.freeze(u),u}(),wt=function(n){var t=i(n),f=function(){return u},r=function(t){return t(n)},u={fold:function(t,i){return i(n)},is:function(t){return n===t},isSome:yt,isNone:w,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:f,orThunk:f,map:function(t){return wt(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?u:pt},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,i){return t.fold(w,function(t){return i(n,t)})}};return u},df=function(n){return n===null||n===undefined?pt:wt(n)},e={some:wt,none:tt,from:df},gf=function(n){if(n===null)return"null";var t=typeof n;return t==="object"&&(Array.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="String")?"string":t},b=function(n){return function(t){return gf(t)===n}},gi=b("string"),ne=b("array"),te=b("boolean"),nr=b("function"),ie=b("number"),tr=Array.prototype.slice,re=Array.prototype.push,c=function(n,t){for(var f,r=n.length,u=new Array(r),i=0;i<r;i++)f=n[i],u[i]=t(f,i);return u},o=function(n,t){for(var u,i=0,r=n.length;i<r;i++)u=n[i],t(u,i)},bt=function(n,t){for(var r,u=[],i=0,f=n.length;i<f;i++)r=n[i],t(r,i)&&u.push(r);return u},ue=function(n,t){var r,s,f,e;if(n.length===0)return[];var o=t(n[0]),u=[],i=[];for(r=0,s=n.length;r<s;r++)f=n[r],e=t(f),e!==o&&(u.push(i),i=[]),o=e,i.push(f);return i.length!==0&&u.push(i),u},ir=function(n,t,i){return o(n,function(n){i=t(i,n)}),i},kt=function(n,t){for(var r,i=0,u=n.length;i<u;i++)if(r=n[i],t(r,i))return e.some(r);return e.none()},fe=function(n){for(var i=[],t=0,r=n.length;t<r;++t){if(!ne(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);re.apply(i,n[t])}return i},rr=function(n,t){return fe(c(n,t))},ee=function(n){var t=tr.call(n,0);return t.reverse(),t},dt=function(n){return n.length===0?e.none():e.some(n[0])},it=function(n){return n.length===0?e.none():e.some(n[n.length-1])},lv=nr(Array.from)?Array.from:function(n){return tr.call(n)},ur=function(n,t,i){return(n.compareDocumentPosition(t)&i)!=0},oe=function(t,i){return ur(t,i,n.Node.DOCUMENT_POSITION_PRECEDING)},se=function(t,i){return ur(t,i,n.Node.DOCUMENT_POSITION_CONTAINED_BY)},he={documentPositionPreceding:oe,documentPositionContainedBy:se},gt=function(){return gt=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},gt.apply(this,arguments)},ni=function(n){var t=n,i=function(){return t},r=function(n){t=n},u=function(){return ni(i())};return{get:i,set:r,clone:u}},ce=function(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i],r.test(t))return r;return undefined},le=function(n,t){var r=ce(n,t),i;return r?(i=function(n){return Number(t.replace(r,"$"+n))},ti(i(1),i(2))):{major:0,minor:0}},ae=function(n,t){var i=String(t).toLowerCase();return n.length===0?fr():le(n,i)},fr=function(){return ti(0,0)},ti=function(n,t){return{major:n,minor:t}},rt={nu:ti,detect:ae,unknown:fr},er="Edge",or="Chrome",sr="IE",hr="Opera",cr="Firefox",lr="Safari",y=function(n,t){return function(){return t===n}},ve=function(){return ar({current:undefined,version:rt.unknown()})},ar=function(n){var t=n.current,i=n.version;return{current:t,version:i,isEdge:y(er,t),isChrome:y(or,t),isIE:y(sr,t),isOpera:y(hr,t),isFirefox:y(cr,t),isSafari:y(lr,t)}},vr={unknown:ve,nu:ar,edge:i(er),chrome:i(or),ie:i(sr),opera:i(hr),firefox:i(cr),safari:i(lr)},yr="Windows",pr="iOS",wr="Android",br="Linux",kr="OSX",dr="Solaris",gr="FreeBSD",nu="ChromeOS",a=function(n,t){return function(){return t===n}},ye=function(){return tu({current:undefined,version:rt.unknown()})},tu=function(n){var t=n.current,i=n.version;return{current:t,version:i,isWindows:a(yr,t),isiOS:a(pr,t),isAndroid:a(wr,t),isOSX:a(kr,t),isLinux:a(br,t),isSolaris:a(dr,t),isFreeBSD:a(gr,t),isChromeOS:a(nu,t)}},iu={unknown:ye,nu:tu,windows:i(yr),ios:i(pr),android:i(wr),linux:i(br),osx:i(kr),solaris:i(dr),freebsd:i(gr),chromeos:i(nu)},pe=function(n,t,r,u){var f=n.isiOS()&&/ipad/i.test(r)===!0,e=n.isiOS()&&!f,o=n.isiOS()||n.isAndroid(),l=o||u("(pointer:coarse)"),s=f||!e&&o&&u("(min-device-width:768px)"),h=e||o&&!s,c=t.isSafari()&&n.isiOS()&&/safari/i.test(r)===!1,a=!h&&!s&&!c;return{isiPad:i(f),isiPhone:i(e),isTablet:i(s),isPhone:i(h),isTouch:i(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:i(c),isDesktop:i(a)}},ru=function(n,t){var i=String(t).toLowerCase();return kt(n,function(n){return n.search(i)})},we=function(n,t){return ru(n,t).map(function(n){var i=rt.detect(n.versionRegexes,t);return{current:n.name,version:i}})},be=function(n,t){return ru(n,t).map(function(n){var i=rt.detect(n.versionRegexes,t);return{current:n.name,version:i}})},uu={detectBrowser:we,detectOs:be},f=function(n,t){return n.indexOf(t)!==-1},ii=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,l=function(n){return function(t){return f(t,n)}},ke=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return f(n,"edge/")&&f(n,"chrome")&&f(n,"safari")&&f(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ii],search:function(n){return f(n,"chrome")&&!f(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return f(n,"msie")||f(n,"trident")}},{name:"Opera",versionRegexes:[ii,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:l("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:l("firefox")},{name:"Safari",versionRegexes:[ii,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(f(n,"safari")||f(n,"mobile/"))&&f(n,"applewebkit")}}],de=[{name:"Windows",search:l("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return f(n,"iphone")||f(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:l("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:l("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:l("linux"),versionRegexes:[]},{name:"Solaris",search:l("sunos"),versionRegexes:[]},{name:"FreeBSD",search:l("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:l("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],fu={browsers:i(ke),oses:i(de)},ge=function(n,t){var u=fu.browsers(),f=fu.oses(),i=uu.detectBrowser(u,n).fold(vr.unknown,vr.nu),r=uu.detectOs(f,n).fold(iu.unknown,iu.nu),e=pe(r,i,n,t);return{browser:i,os:r,deviceType:e}},no={detect:ge},to=function(t){return n.window.matchMedia(t).matches},io=ni(no.detect(n.navigator.userAgent,to)),ro=function(){return io.get()},uo=function(t,i){var u=i||n.document,r=u.createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1){n.console.error("HTML does not have a single root node",t);throw new Error("HTML must have a single root node");}return k(r.childNodes[0])},fo=function(t,i){var r=i||n.document,u=r.createElement(t);return k(u)},eo=function(t,i){var r=i||n.document,u=r.createTextNode(t);return k(u)},k=function(n){if(n===null||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:i(n)}},oo=function(n,t,i){var r=n.dom();return e.from(r.elementFromPoint(t,i)).map(k)},r={fromHtml:uo,fromTag:fo,fromText:eo,fromDom:k,fromPoint:oo},av=n.Node.ATTRIBUTE_NODE,vv=n.Node.CDATA_SECTION_NODE,yv=n.Node.COMMENT_NODE,pv=n.Node.DOCUMENT_NODE,wv=n.Node.DOCUMENT_TYPE_NODE,bv=n.Node.DOCUMENT_FRAGMENT_NODE,eu=n.Node.ELEMENT_NODE,kv=n.Node.TEXT_NODE,dv=n.Node.PROCESSING_INSTRUCTION_NODE,gv=n.Node.ENTITY_REFERENCE_NODE,ny=n.Node.ENTITY_NODE,ty=n.Node.NOTATION_NODE,so=eu,ho=function(n,t){var r=n.dom(),i;if(r.nodeType!==so)return!1;if(i=r,i.matches!==undefined)return i.matches(t);if(i.msMatchesSelector!==undefined)return i.msMatchesSelector(t);if(i.webkitMatchesSelector!==undefined)return i.webkitMatchesSelector(t);if(i.mozMatchesSelector!==undefined)return i.mozMatchesSelector(t);throw new Error("Browser lacks native selectors");},ou=function(n,t){return n.dom()===t.dom()},co=function(n,t){var i=n.dom(),r=t.dom();return i===r?!1:i.contains(r)},lo=function(n,t){return he.documentPositionContainedBy(n.dom(),t.dom())},ao=ro().browser,vo=ao.isIE()?lo:co,ut=ho,su=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),yo=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ft=tinymce.util.Tools.resolve("tinymce.util.VK"),hu=function(n,t,i){return n.isSome()&&t.isSome()?e.some(i(n.getOrDie(),t.getOrDie())):e.none()},po=function(t,i){var f=i||n.document,u=f.createDocumentFragment();return o(t,function(n){u.appendChild(n.dom())}),r.fromDom(u)},wo=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var u,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(n.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+t.length+" arguments");return u={},o(n,function(n,r){u[n]=i(t[r])}),u}},bo=Object.keys,ko=function(n,t){for(var r,f,u=bo(n),i=0,e=u.length;i<e;i++)r=u[i],f=n[r],t(f,r)},ri=function(n){return e.from(n.dom().parentNode).map(r.fromDom)},ui=function(n){return c(n.dom().childNodes,r.fromDom)},cu=function(n,t){var i=n.dom().childNodes;return e.from(i[t]).map(r.fromDom)},lu=function(n){return cu(n,0)},au=function(n){return cu(n,n.dom().childNodes.length-1)},iy=wo("element","offset"),vu=function(n,t){var i=ri(n);i.each(function(i){i.dom().insertBefore(t.dom(),n.dom())})},et=function(n,t){n.dom().appendChild(t.dom())},go=function(n,t){o(t,function(t){vu(n,t)})},fi=function(n,t){o(t,function(t){et(n,t)})},yu=function(n){var t=n.dom();t.parentNode!==null&&t.parentNode.removeChild(t)},d=function(n,t,i){return n.fire("ListMutation",{action:t,element:i})},ns=typeof n.window!="undefined"?n.window:Function("return this;")(),ts=function(n,t){for(var i=t!==undefined&&t!==null?t:ns,r=0;r<n.length&&i!==undefined&&i!==null;++r)i=i[n[r]];return i},pu=function(n,t){var i=n.split(".");return ts(i,t)},is=function(n,t){return pu(n,t)},rs=function(n,t){var i=is(n,t);if(i===undefined||i===null)throw new Error(n+" not available on this browser");return i},us={getOrDie:rs},fs=function(n){return us.getOrDie("HTMLElement",n)},es=function(n){var t=pu("ownerDocument.defaultView",n);return fs(t).prototype.isPrototypeOf(n)},os={isPrototypeOf:es},wu=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),u=tinymce.util.Tools.resolve("tinymce.util.Tools"),ss=function(n){return n&&n.nodeType===3},hs=function(n){return n&&/^(OL|UL|DL)$/.test(n.nodeName)},cs=function(n){return n&&/^(OL|UL)$/.test(n.nodeName)},ls=function(n){return n&&/^(LI|DT|DD)$/.test(n.nodeName)},as=function(n){return n&&/^(DT|DD)$/.test(n.nodeName)},vs=function(n){return n&&/^(TH|TD)$/.test(n.nodeName)},ei=function(n){return n&&n.nodeName==="BR"},ys=function(n){return n.parentNode.firstChild===n},ps=function(n){return n.parentNode.lastChild===n},ws=function(n,t){return t&&!!n.schema.getTextBlockElements()[t.nodeName]},bs=function(n,t){return n&&n.nodeName in t},ks=function(n,t){return ei(t)?n.isBlock(t.nextSibling)&&!ei(t.previousSibling)?!0:!1:!1},ds=function(n,t,i){var r=n.isEmpty(t);return i&&n.select("span[data-mce-type=bookmark]",t).length>0?!1:r},gs=function(n,t){return n.isChildOf(t,n.getRoot())},t={isTextNode:ss,isListNode:hs,isOlUlNode:cs,isDlItemNode:as,isListItemNode:ls,isTableCellNode:vs,isBr:ei,isFirstChild:ys,isLastChild:ps,isTextBlock:ws,isBlock:bs,isBogusBr:ks,isEmpty:ds,isChildOfBody:gs},oi=function(n){var t=n.selection.getStart(!0);return n.dom.getParent(t,"OL,UL,DL",ot(n,t))},nh=function(n,t){return n&&t.length===1&&t[0]===n},th=function(n){return u.grep(n.querySelectorAll("ol,ul,dl"),function(n){return t.isListNode(n)})},ih=function(n){var i=oi(n),r=n.selection.getSelectedBlocks();return nh(i,r)?th(i):u.grep(r,function(n){return t.isListNode(n)&&i!==n})},rh=function(n,t){var i=u.map(t,function(t){var i=n.dom.getParent(t,"li,dd,dt",ot(n,t));return i?i:t});return wu.unique(i)},bu=function(n){var i=n.selection.getSelectedBlocks();return u.grep(rh(n,i),function(n){return t.isListItemNode(n)})},uh=function(n){return bt(bu(n),t.isDlItemNode)},ot=function(n,t){var i=n.dom.getParents(t,"TD,TH");return i.length>0?i[0]:n.getBody()},ku=function(n,t){var i=n.dom.getParents(t,"ol,ul",ot(n,t));return it(i)},fh=function(n){var i=ku(n,n.selection.getStart()),r=bt(n.selection.getSelectedBlocks(),t.isOlUlNode);return i.toArray().concat(r)},eh=function(n){var t=fh(n);return oh(n,t)},oh=function(n,t){var i=c(t,function(t){return ku(n,t).getOr(t)});return wu.unique(i)},sh=function(n){var t=oi(n);return os.isPrototypeOf(t)},s={isList:sh,getParentList:oi,getSelectedSubLists:ih,getSelectedListItems:bu,getClosestListRootElm:ot,getSelectedDlItems:uh,getSelectedListRoots:eh},hh=function(n){return n.getParam("lists_indent_on_tab",!0)},ch=function(n){var t=n.getParam("forced_root_block","p");return t===!1?"":t===!0?"p":t},lh=function(n){return n.getParam("forced_root_block_attrs",{})},si={shouldIndentOnTab:hh,getForcedRootBlock:ch,getForcedRootBlockAttrs:lh},du=function(n,i){var f=n.dom,h=n.schema.getBlockElements(),e=f.createFragment(),o=si.getForcedRootBlock(n),u,r,s,c;if(o&&(r=f.create(o),r.tagName===o.toUpperCase()&&f.setAttribs(r,si.getForcedRootBlockAttrs(n)),t.isBlock(i.firstChild,h)||e.appendChild(r)),i)while(u=i.firstChild)c=u.nodeName,s||c==="SPAN"&&u.getAttribute("data-mce-type")==="bookmark"||(s=!0),t.isBlock(u,h)?(e.appendChild(u),r=null):o?(r||(r=f.create(o),e.appendChild(r)),r.appendChild(u)):e.appendChild(u);return o?s||r.appendChild(f.create("br",{"data-mce-bogus":"1"})):e.appendChild(f.create("br")),e},gu=function(n){var t=n.dom().nodeName;return t.toLowerCase()},ah=function(n){return n.dom().nodeType},vh=function(n){return function(t){return ah(t)===n}},yh=vh(eu),ph=function(t,i,r){if(gi(r)||te(r)||ie(r))t.setAttribute(i,r+"");else{n.console.error("Invalid call to Attr.set. Key ",i,":: Value ",r,":: Element ",t);throw new Error("Attribute value was not simple");}},g=function(n,t){var i=n.dom();ko(t,function(n,t){ph(i,t,n)})},hi=function(n){return ir(n.dom().attributes,function(n,t){return n[t.name]=t.value,n},{})},wh=function(n){return n.style!==undefined&&nr(n.style.getPropertyValue)},bh=function(t,i,r){if(!gi(r)){n.console.error("Invalid call to CSS.set. Property ",i,":: Value ",r,":: Element ",t);throw new Error("CSS value must be a string: "+r);}wh(t)&&t.style.setProperty(i,r)},kh=function(n,t,i){var r=n.dom();bh(r,t,i)},dh=function(n,t){return r.fromDom(n.dom().cloneNode(t))},gh=function(n){return dh(n,!0)},nc=function(n,t){var i=r.fromTag(t),u=hi(n);return g(i,u),i},ci=function(n,t){var i=nc(n,t),r;return vu(n,i),r=ui(n),fi(i,r),yu(n),i},nf=function(n,t){et(n.item,t.list)},tc=function(n){for(var t=1;t<n.length;t++)nf(n[t-1],n[t])},ic=function(n,t){hu(it(n),dt(t),nf)},rc=function(n,t){var i={list:r.fromTag(t,n),item:r.fromTag("li",n)};return et(i.list,i.item),i},uc=function(n,t,i){for(var r=[],u=0;u<i;u++)r.push(rc(n,t.listType));return r},fc=function(n,t){for(var i=0;i<n.length-1;i++)kh(n[i].item,"list-style-type","none");it(n).each(function(n){g(n.list,t.listAttributes);g(n.item,t.itemAttributes);fi(n.item,t.content)})},ec=function(n,t){gu(n.list)!==t.listType&&(n.list=ci(n.list,t.listType));g(n.list,t.listAttributes)},oc=function(n,t,i){var u=r.fromTag("li",n);return g(u,t),fi(u,i),u},sc=function(n,t){et(n.list,t);n.item=t},hc=function(n,t,i){var r=t.slice(0,i.depth);return it(r).each(function(t){var r=oc(n,i.itemAttributes,i.content);sc(t,r);ec(t,i)}),r},cc=function(n,t,i){var r=uc(n,i,i.depth-t.length);return tc(r),fc(r,i),ic(t,r),t.concat(r)},lc=function(n,t){var i=ir(t,function(t,i){return i.depth>t.length?cc(n,t,i):hc(n,t,i)},[]);return dt(i).map(function(n){return n.list})},nt=function(n){return ut(n,"OL,UL")},tf=function(n){return lu(n).map(nt).getOr(!1)},ac=function(n){return au(n).map(nt).getOr(!1)},rf=function(n){return n.depth>0},vc=function(n){return n.isSelected},yc=function(n){var t=ui(n),i=ac(n)?t.slice(0,-1):t;return c(i,gh)},pc=function(n,t,i){return ri(n).filter(yh).map(function(r){return{depth:t,isSelected:i,content:yc(n),itemAttributes:hi(n),listAttributes:hi(r),listType:gu(r)}})},wc=function(n,t){switch(n){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}},bc=function(n,t){n.listType=t.listType;n.listAttributes=gt({},t.listAttributes)},kc=function(n,t){for(var r=n[t].depth,i=t-1;i>=0;i--){if(n[i].depth===r)return e.some(n[i]);if(n[i].depth<r)break}return e.none()},dc=function(n){o(n,function(t,i){kc(n,i).each(function(n){bc(t,n)})})},gc=function(n,t,i,r){return lu(r).filter(nt).fold(function(){var u,f;return t.each(function(n){ou(n.start,r)&&i.set(!0)}),u=pc(r,n,i.get()),t.each(function(n){ou(n.end,r)&&i.set(!1)}),f=au(r).filter(nt).map(function(r){return st(n,t,i,r)}).getOr([]),u.toArray().concat(f)},function(r){return st(n,t,i,r)})},st=function(n,t,i,r){return rr(ui(r),function(r){var u=nt(r)?st:gc,f=n+1;return u(f,t,i,r)})},nl=function(n,t){var i=ni(!1),r=0;return c(n,function(n){return{sourceList:n,entries:st(r,t,i,n)}})},tl=function(n,t){return c(t,function(t){var i=po(t.content);return r.fromDom(du(n,i.dom()))})},il=function(n,t){return dc(t),lc(n.contentDocument,t).toArray()},rl=function(n,t){return rr(ue(t,rf),function(t){var i=dt(t).map(rf).getOr(!1);return i?il(n,t):tl(n,t)})},ul=function(n,t){o(bt(n,vc),function(n){return wc(t,n)})},fl=function(n){var t=c(s.getSelectedListItems(n),r.fromDom);return hu(kt(t,di(tf)),kt(ee(t),di(tf)),function(n,t){return{start:n,end:t}})},el=function(n,t,i){var r=nl(t,fl(n));o(r,function(t){ul(t.entries,i);var r=rl(n,t.entries);o(r,function(t){d(n,i==="Indent"?"IndentList":"OutdentList",t.dom())});go(t.sourceList,r);yu(t.sourceList)})},li=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),v=li.DOM,ol=function(n,i,r){var e,o,s,f,h,c=function(n){u.each(s,function(t){n.parentNode.insertBefore(t,r.parentNode)});v.remove(n)};for(s=v.select('span[data-mce-type="bookmark"]',i),h=du(n,r),e=v.createRng(),e.setStartAfter(r),e.setEndAfter(i),o=e.extractContents(),f=o.firstChild;f;f=f.firstChild)if(f.nodeName==="LI"&&n.dom.isEmpty(f)){v.remove(f);break}n.dom.isEmpty(o)||v.insertAfter(o,i);v.insertAfter(h,i);t.isEmpty(n.dom,r.parentNode)&&c(r.parentNode);v.remove(r);t.isEmpty(n.dom,i)&&v.remove(i)},sl={splitList:ol},hl=function(n,t){ut(t,"dd")?ci(t,"dt"):ut(t,"dt")&&ri(t).each(function(i){return sl.splitList(n,i.dom(),t.dom())})},cl=function(n){ut(n,"dt")&&ci(n,"dd")},ll=function(n,t,i){t==="Indent"?o(i,cl):o(i,function(t){return hl(n,t)})},ai=function(n,i){if(t.isTextNode(n))return{container:n,offset:i};var r=su.getNode(n,i);return t.isTextNode(r)?{container:r,offset:i>=n.childNodes.length?r.data.length:0}:r.previousSibling&&t.isTextNode(r.previousSibling)?{container:r.previousSibling,offset:r.previousSibling.data.length}:r.nextSibling&&t.isTextNode(r.nextSibling)?{container:r.nextSibling,offset:0}:{container:n,offset:i}},al=function(n){var t=n.cloneRange(),r=ai(n.startContainer,n.startOffset),i;return t.setStart(r.container,r.offset),i=ai(n.endContainer,n.endOffset),t.setEnd(i.container,i.offset),t},ht={getNormalizedPoint:ai,normalizeRange:al},vi=function(n,t){var i=c(s.getSelectedListRoots(n),r.fromDom),u=c(s.getSelectedDlItems(n),r.fromDom),f=!1,e;return(i.length||u.length)&&(e=n.selection.getBookmark(),el(n,i,t),ll(n,t,u),n.selection.moveToBookmark(e),n.selection.setRng(ht.normalizeRange(n.selection.getRng())),n.nodeChanged(),f=!0),f},uf=function(n){return vi(n,"Indent")},yi=function(n){return vi(n,"Outdent")},ct=function(n){return vi(n,"Flatten")},vl=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),p=li.DOM,yl=function(n){var t={},i=function(i){var f,r,u;r=n[i?"startContainer":"endContainer"];u=n[i?"startOffset":"endOffset"];r.nodeType===1&&(f=p.create("span",{"data-mce-type":"bookmark"}),r.hasChildNodes()?(u=Math.min(u,r.childNodes.length-1),i?r.insertBefore(f,r.childNodes[u]):p.insertAfter(f,r.childNodes[u])):r.appendChild(f),r=f,u=0);t[i?"startContainer":"endContainer"]=r;t[i?"startOffset":"endOffset"]=u};return i(!0),n.collapsed||i(),t},pl=function(n){function i(t){var i,r,u,f=function(n){for(var t=n.parentNode.firstChild,i=0;t;){if(t===n)return i;(t.nodeType!==1||t.getAttribute("data-mce-type")!=="bookmark")&&i++;t=t.nextSibling}return-1};(i=u=n[t?"startContainer":"endContainer"],r=n[t?"startOffset":"endOffset"],i)&&(i.nodeType===1&&(r=f(i),i=i.parentNode,p.remove(u),!i.hasChildNodes()&&p.isBlock(i)&&i.appendChild(p.create("br"))),n[t?"startContainer":"endContainer"]=i,n[t?"startOffset":"endOffset"]=r)}i(!0);i();var t=p.createRng();return t.setStart(n.startContainer,n.startOffset),n.endContainer&&t.setEnd(n.endContainer,n.endOffset),ht.normalizeRange(t)},h={createBookmark:yl,resolveBookmark:pl},ff=function(n){return/\btox\-/.test(n.className)},lt=function(n){switch(n){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},wl=function(n,t,i){var r=i["list-style-type"]?i["list-style-type"]:null;n.setStyle(t,"list-style-type",r)},ef=function(n,t){u.each(t,function(t,i){n.setAttribute(i,t)})},bl=function(n,t,i){ef(t,i["list-attributes"]);u.each(n.select("li",t),function(n){ef(n,i["list-item-attributes"])})},at=function(n,t,i){wl(n,t,i);bl(n,t,i)},kl=function(n,t,i){u.each(i,function(i){var r;return n.setStyle(t,(r={},r[i]="",r))})},sf=function(n,i,r,u){var f,e;for(f=i[r?"startContainer":"endContainer"],e=i[r?"startOffset":"endOffset"],f.nodeType===1&&(f=f.childNodes[Math.min(e,f.childNodes.length-1)]||f),!r&&t.isBr(f.nextSibling)&&(f=f.nextSibling);f.parentNode!==u;){if(t.isTextBlock(n,f)||/^(TD|TH)$/.test(f.parentNode.nodeName))return f;f=f.parentNode}return f},dl=function(n,i,r){for(var o=[],s=n.dom,c=sf(n,i,!0,r),l=sf(n,i,!1,r),f,h=[],e=c;e;e=e.nextSibling)if(h.push(e),e===l)break;return u.each(h,function(i){if(t.isTextBlock(n,i)){o.push(i);f=null;return}if(s.isBlock(i)||t.isBr(i)){t.isBr(i)&&s.remove(i);f=null;return}var u=i.nextSibling;if(vl.isBookmarkNode(i)&&(t.isTextBlock(n,u)||!u&&i.parentNode===r)){f=null;return}f||(f=s.create("p"),i.parentNode.insertBefore(f,i),o.push(f));f.appendChild(i)}),o},gl=function(n,t,i){var u=n.getStyle(t,"list-style-type"),r=i?i["list-style-type"]:"";return r=r===null?"":r,u===r},na=function(n,i,r){r===void 0&&(r={});var o=n.selection.getRng(!0),c,e="LI",l=s.getClosestListRootElm(n,n.selection.getStart(!0)),f=n.dom;f.getContentEditable(n.selection.getNode())!=="false"&&(i=i.toUpperCase(),i==="DL"&&(e="DT"),c=h.createBookmark(o),u.each(dl(n,o,l),function(u){var s,o;o=u.previousSibling;o&&t.isListNode(o)&&o.nodeName===i&&gl(f,o,r)?(s=o,u=f.rename(u,e),o.appendChild(u)):(s=f.create(i),u.parentNode.insertBefore(s,u),s.appendChild(u),u=f.rename(u,e));kl(f,u,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]);at(f,s,r);pi(n.dom,s)}),n.selection.setRng(h.resolveBookmark(c)))},ta=function(n,i){return n&&i&&t.isListNode(n)&&n.nodeName===i.nodeName},ia=function(n,t,i){var r=n.getStyle(t,"list-style-type",!0),u=n.getStyle(i,"list-style-type",!0);return r===u},ra=function(n,t){return n.className===t.className},hf=function(n,t,i){return ta(t,i)&&ia(n,t,i)&&ra(t,i)},pi=function(n,t){var i,r;if(i=t.nextSibling,hf(n,t,i)){while(r=i.firstChild)t.appendChild(r);n.remove(i)}if(i=t.previousSibling,hf(n,t,i)){while(r=i.lastChild)t.insertBefore(r,t.firstChild);n.remove(i)}},ua=function(n,t,i,r){if(t.nodeName!==i){var u=n.dom.rename(t,i);at(n.dom,u,r);d(n,lt(i),u)}else at(n.dom,t,r),d(n,lt(i),t)},fa=function(n,t,i,r,f){if(t.nodeName!==r||cf(f)){var e=h.createBookmark(n.selection.getRng(!0));u.each([t].concat(i),function(t){ua(n,t,r,f)});n.selection.setRng(h.resolveBookmark(e))}else ct(n)},cf=function(n){return"list-style-type"in n},ea=function(n,t,i,r){var f,u;t!==n.getBody()&&(t?t.nodeName!==i||cf(r)||ff(t)?(f=h.createBookmark(n.selection.getRng(!0)),at(n.dom,t,r),u=n.dom.rename(t,i),pi(n.dom,u),n.selection.setRng(h.resolveBookmark(f)),d(n,lt(i),u)):ct(n):(na(n,i,r),d(n,lt(i),t)))},oa=function(n,t,i){var r=s.getParentList(n),u=s.getSelectedSubLists(n);i=i?i:{};r&&u.length>0?fa(n,r,u,t,i):ea(n,r,t,i)},vt={toggleList:oa,mergeWithAdjacentLists:pi},lf=li.DOM,af=function(n,i){var r,u=i.parentNode;u.nodeName==="LI"&&u.firstChild===i&&(r=u.previousSibling,r&&r.nodeName==="LI"?(r.appendChild(i),t.isEmpty(n,u)&&lf.remove(u)):lf.setStyle(u,"listStyleType","none"));t.isListNode(u)&&(r=u.previousSibling,r&&r.nodeName==="LI"&&r.appendChild(i))},sa=function(n,t){u.each(u.grep(n.select("ol,ul",t)),function(t){af(n,t)})},ha={normalizeList:af,normalizeLists:sa},vf=function(n,i,r,u){var f=i.startContainer,e=i.startOffset,s,o;if(t.isTextNode(f)&&(r?e<f.data.length:e>0))return f;for(s=n.schema.getNonEmptyElements(),f.nodeType===1&&(f=su.getNode(f,e)),o=new yo(f,u),r&&t.isBogusBr(n.dom,f)&&o.next();f=o[r?"next":"prev2"]();)if(f.nodeName==="LI"&&!f.hasChildNodes()||s[f.nodeName]||t.isTextNode(f)&&f.data.length>0)return f},yf=function(n,i){var r=i.childNodes;return r.length===1&&!t.isListNode(r[0])&&n.isBlock(r[0])},ca=function(n,t){yf(n,t)&&n.remove(t.firstChild,!0)},la=function(n,i,r){var u,f;if(f=yf(n,r)?r.firstChild:r,ca(n,i),!t.isEmpty(n,i,!0))while(u=i.firstChild)f.appendChild(u)},wi=function(n,i,u){var f,e,s=i.parentNode,h,c;t.isChildOfBody(n,i)&&t.isChildOfBody(n,u)&&(t.isListNode(u.lastChild)&&(e=u.lastChild),s===u.lastChild&&t.isBr(s.previousSibling)&&n.remove(s.previousSibling),f=u.lastChild,f&&t.isBr(f)&&i.hasChildNodes()&&n.remove(f),t.isEmpty(n,u,!0)&&n.$(u).empty(),la(n,i,u),e&&u.appendChild(e),h=vo(r.fromDom(u),r.fromDom(i)),c=h?n.getParents(i,t.isListNode,u):[],n.remove(i),o(c,function(i){t.isEmpty(n,i)&&i!==n.getRoot()&&n.remove(i)}))},aa=function(n,t,i){n.dom.$(i).empty();wi(n.dom,t,i);n.selection.setCursorLocation(i)},va=function(n,t,i,r){var u=n.dom,f;u.isEmpty(r)?aa(n,i,r):(f=h.createBookmark(t),wi(u,i,r),n.selection.setRng(h.resolveBookmark(f)))},ya=function(n,t,i,r){var f=h.createBookmark(t),u;wi(n.dom,i,r);u=h.resolveBookmark(f);n.selection.setRng(u)},pa=function(n,i){var e=n.dom,o=n.selection,l=o.getStart(),h=s.getClosestListRootElm(n,l),r=e.getParent(o.getStart(),"LI",h),c,u,f;if(r){if(c=r.parentNode,c===n.getBody()&&t.isEmpty(e,c))return!0;if(u=ht.normalizeRange(o.getRng()),f=e.getParent(vf(n,u,i,h),"LI",h),f&&f!==r)return n.undoManager.transact(function(){i?va(n,u,f,r):t.isFirstChild(r)?yi(n):ya(n,u,r,f)}),!0;if(!f&&!i&&u.startOffset===0&&u.endOffset===0)return n.undoManager.transact(function(){ct(n)}),!0}return!1},wa=function(n,t,i){var r=n.getParent(t.parentNode,n.isBlock,i);n.remove(t);r&&n.isEmpty(r)&&n.remove(r)},ba=function(n,t){var i=n.dom,e=n.selection.getStart(),r=s.getClosestListRootElm(n,e),f=i.getParent(e,i.isBlock,r),o,u;return f&&i.isEmpty(f)&&(o=ht.normalizeRange(n.selection.getRng()),u=i.getParent(vf(n,o,t,r),"LI",r),u)?(n.undoManager.transact(function(){wa(i,f,r);vt.mergeWithAdjacentLists(i,u.parentNode);n.selection.select(u,!0);n.selection.collapse(t)}),!0):!1},ka=function(n,t){return pa(n,t)||ba(n,t)},da=function(n){var t=n.selection.getStart(),i=s.getClosestListRootElm(n,t),r=n.dom.getParent(t,"LI,DT,DD",i);return r||s.getSelectedListItems(n).length>0?(n.undoManager.transact(function(){n.execCommand("Delete");ha.normalizeLists(n.dom,n.getBody())}),!0):!1},bi=function(n,t){return n.selection.isCollapsed()?ka(n,t):da(n)},ga=function(n){n.on("keydown",function(t){t.keyCode===ft.BACKSPACE?bi(n,!1)&&t.preventDefault():t.keyCode===ft.DELETE&&bi(n,!0)&&t.preventDefault()})},pf={setup:ga,backspaceDelete:bi},nv=function(n){return{backspaceDelete:function(t){pf.backspaceDelete(n,t)}}},tv={get:nv},ki=function(n,t){return function(){var i=n.dom.getParent(n.selection.getStart(),"UL,OL,DL");return i&&i.nodeName===t}},iv=function(n){n.on("BeforeExecCommand",function(t){var i=t.command.toLowerCase();i==="indent"?uf(n):i==="outdent"&&yi(n)});n.addCommand("InsertUnorderedList",function(t,i){vt.toggleList(n,"UL",i)});n.addCommand("InsertOrderedList",function(t,i){vt.toggleList(n,"OL",i)});n.addCommand("InsertDefinitionList",function(t,i){vt.toggleList(n,"DL",i)});n.addCommand("RemoveList",function(){ct(n)});n.addQueryStateHandler("InsertUnorderedList",ki(n,"UL"));n.addQueryStateHandler("InsertOrderedList",ki(n,"OL"));n.addQueryStateHandler("InsertDefinitionList",ki(n,"DL"))},rv={register:iv},uv=function(n){n.on("keydown",function(t){t.keyCode!==ft.TAB||ft.metaKeyPressed(t)||n.undoManager.transact(function(){(t.shiftKey?yi(n):uf(n))&&t.preventDefault()})})},fv=function(n){si.shouldIndentOnTab(n)&&uv(n);pf.setup(n)},ev={setup:fv},ov=function(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i],t(r))return i;return-1},wf=function(n,i){return function(r){var f=function(n){var e=ov(n.parents,t.isTableCellNode),o=e!==-1?n.parents.slice(0,e):n.parents,f=u.grep(o,t.isListNode);r.setActive(f.length>0&&f[0].nodeName===i&&!ff(f[0]))};n.on("NodeChange",f);return function(){return n.off("NodeChange",f)}}},sv=function(n){var i=function(n,t){var i=n.settings.plugins?n.settings.plugins:"";return u.inArray(i.split(/[ ,]/),t)!==-1},t=function(t){return function(){return n.execCommand(t)}};i(n,"advlist")||(n.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:wf(n,"OL")}),n.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:wf(n,"UL")}))},hv={register:sv};cv()})(window);