# ?? ???? ??????? ??????? - Blazor WASM

## ???????: ??? 404 ?? ????? ????? .wasm ?? .pdb

---

## ? ???? ?????? (5 ?????)

### 1?? **???? ??? Cache ???????**

```powershell
cd src\Presentation\Dashboard
.\clear-cache.ps1
```

?? ??????:

```powershell
# ???? ???????
Ctrl + C

# ???? bin/obj
Remove-Item bin,obj -Recurse -Force

# ??? ???????
dotnet clean
```

---

### 2?? **??? ?????? ?? ?????**

```powershell
dotnet build --no-incremental
```

---

### 3?? **??? cache ???????**

#### ?? Chrome/Edge:
1. ???? `Ctrl + Shift + Delete`
2. ???? "Cached images and files"
3. ???? "All time"
4. ???? "Clear data"

**?? ???? ?? Incognito:**
```
Ctrl + Shift + N (Chrome/Edge)
Ctrl + Shift + P (Firefox)
```

---

### 4?? **???? ???????**

```powershell
dotnet run
```

---

### 5?? **???? ??????? ?? Hard Refresh**

```
https://localhost:7282
```

????: `Ctrl + Shift + R` (Hard refresh)

---

## ?? ?????? ?? ???? ????

### ?? Console (F12):

**??? ?? ???:**
```
? [BLOCKED] Debug file: Dashboard.c8ni4e020j.pdb
? Blazor started successfully
? Application loaded
```

**??? ??? ???:**
```
? Error in mono_download_assets
? download ... failed 404
? still waiting on run dependencies
```

---

## ??? ???? ??????

### ??? ?? ???? ??????? ??????:

#### ???? 1: ???? Service Worker

**?? Console (F12):**
```javascript
// ???? Service Workers
navigator.serviceWorker.getRegistrations()
  .then(regs => regs.forEach(reg => reg.unregister()));

// ???? ?? Cache
caches.keys()
  .then(names => names.forEach(name => caches.delete(name)));

// ??? ????? ??????
location.reload(true);
```

---

#### ???? 2: ???? ?? ????? _framework

```powershell
# ???? ?? ???? ???????
cd bin\Debug\net10.0\wwwroot\_framework
dir *.wasm

# ??? ?? ???:
# dotnet.native.[hash].wasm
# dotnet.[hash].wasm
```

**??? ???? ??????? ??? ??????:**
```powershell
cd ..\..\..\..  # ???? ???????
dotnet build --no-incremental
```

---

#### ???? 3: ????? Compression ??????

?? `Dashboard.csproj`:

```xml
<!-- ???? ?????? ???????? -->
<BlazorEnableCompression>false</BlazorEnableCompression>
```

??:
```powershell
dotnet clean
dotnet build
dotnet run
```

---

#### ???? 4: ???? ?? ?????? (Port)

???? ?? ??????? ?????? ??????:

```powershell
# ???? ?? ?????? ?? Terminal
# ??? ?? ????:
# Now listening on: https://localhost:7282
```

??? ??? ???????? ?????? ?????? ?????? ?? ???????.

---

## ?? Checklist ??????

- [ ] ?? ??? bin/obj
- [ ] ?? ????? `dotnet clean`
- [ ] ?? ????? `dotnet build` ?????
- [ ] ?? ??? cache ???????
- [ ] ?? ??? ??????? ?? Incognito
- [ ] ?? ????? ??? Ctrl+Shift+R
- [ ] ?? ???? ????? 404 ?? Console
- [ ] ??????? ???? ???? ????

---

## ?? ??????? ???????

### ???: "The file is locked by: .NET Host"

**????:**
```powershell
# ???? ?? ?????? dotnet
Get-Process dotnet | Stop-Process -Force

# ????? 5 ????
Start-Sleep -Seconds 5

# ???? ??? ????
dotnet clean
dotnet build
```

---

### ???: "Failed to find a valid digest"

**????:**
```powershell
# ???? NuGet cache
dotnet nuget locals all --clear

# ??? ??????
dotnet build --no-incremental
```

---

### ???: "WASM file not found"

**?????:** ????? WASM ?? ??? ????? ??? wwwroot

**????:**
```powershell
# ???? ?? ???? ???????
ls bin\Debug\net10.0\wwwroot\_framework\*.wasm

# ??? ???? ??? ??????
dotnet clean
dotnet build
```

---

## ?? ?????

??? ?????? ??????? ??? ?? ??????:

1. **?????? ?? Logs:**
   ```powershell
   dotnet run --verbosity detailed
   ```

2. **?????? ?? ??????? ???????:**
   - ???? `Dashboard.csproj`
   - ???? ??:
     - `<DebugType>none</DebugType>`
     - `<WasmDebugLevel>0</WasmDebugLevel>`

3. **????? ????? ???????:**
   ```powershell
   # Backup important files first!
   dotnet new blazorwasm -o NewDashboard
   # ?? ???? ?????? ????????
   ```

---

## ?? ????????? ???????

### ?? `Dashboard.csproj`:

```xml
<!-- Debug Settings -->
<DebuggerSupport Condition="'$(Configuration)' == 'Debug'">false</DebuggerSupport>
<DebugType Condition="'$(Configuration)' == 'Debug'">none</DebugType>
<DebugSymbols Condition="'$(Configuration)' == 'Debug'">false</DebugSymbols>
<WasmDebugLevel Condition="'$(Configuration)' == 'Debug'">0</WasmDebugLevel>
<CopyOutputSymbolsToOutputDirectory>false</CopyOutputSymbolsToOutputDirectory>
```

### ?? `index.html`:

```javascript
Blazor.start({
    loadBootResource: function(type, name, defaultUri, integrity) {
        if (name.endsWith('.pdb') || 
            name.includes('.pdb.') || 
            name.includes('debug')) {
            console.log(`[BLOCKED] Debug file: ${name}`);
            return null;
        }
        return defaultUri;
    },
    debugBuild: false
});
```

---

**??? ?????:** 2024
**??????:** 1.0
