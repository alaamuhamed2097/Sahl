# ????? ????? ???? ??????? ??? ????? Index

## ? ??????? ????????

### 1. Units (????? ??????)
**??????**: `src\Presentation\Dashboard\Pages\Catalog\Units\Index.razor`

**??????? ??????? ???????**:
- Title (?????)

**Backend**: `src\Core\BL\Service\ECommerce\Unit\UnitService.cs`
- ? ?? ????? ???? ???????
- ????: Title, TitleAr, TitleEn, CreatedDateUtc

---

### 2. States (?????????)
**??????**: `src\Presentation\Dashboard\Pages\Location\State\Index.razor`

**??????? ??????? ???????**:
- Title (?????)

**Backend**: `src\Core\BL\Service\Location\StateService.cs`
- ? ?? ????? ???? ???????
- ????: Title, TitleAr, TitleEn, CreatedDateUtc

---

### 3. Cities (?????)
**??????**: `src\Presentation\Dashboard\Pages\Location\City\Index.razor`

**??????? ??????? ???????**:
- Title (?????)

**Backend**: `src\Core\BL\Service\Location\CityService.cs`
- ?? ?????? ????? ???? (??? ?????) - ????? ????? ????
- ????? ??????? ????? ?? ??? ???????

---

### 4. ShippingCompanies (????? ?????)
**??????**: `src\Presentation\Dashboard\Pages\Shipping\Companies\Index.razor`

**??????? ??????? ???????**:
- Name (?????)
- PhoneNumber (??? ??????)

**Backend**: `src\Core\BL\Service\ShippingCompany\ShippingCompanyService.cs`
- ? ?? ????? ???? ???????
- ????: Name, PhoneNumber, CreatedDateUtc

---

### 5. Categories (?????????)
**??????**: `src\Presentation\Dashboard\Pages\Catalog\Categories\Index.razor`

**???? ????**: ?????? Tree View ???? ???????
- ?? ??? List View: ??????? ????
- ?? ??? Tree View: ??????? ??? ????? (?????? TreeViewSerial)

**Backend**: `src\Core\BL\Service\ECommerce\Category\CategoryService.cs`
- ? ?? ????? ???? ???????
- ????: Title, TitleAr, TitleEn, CreatedDateUtc, TreeViewSerial

---

## ?? ??????? ???????? (????? ?????)

### 6. Currencies (???????)
**??????**: `src\Presentation\Dashboard\Pages\Currency\Index.razor`

**??????? ???????? ???????**:
- Code (?????)
- Name (?????)
- ExchangeRate (??? ?????)

**Backend**: ????? ????? ?? `CurrencyService`

---

### 7. Orders (???????)
**??????**: `src\Presentation\Dashboard\Pages\Sales\Orders\Index.razor`

**??????? ???????? ???????**:
- OrderNumber (??? ?????)
- CustomerName (??? ??????)
- OrderDate (????? ?????)
- Price (?????)
- Status (??????)

**Backend**: ????? ????? ?? `OrderService`

---

### 8. Pages (??????? ???????)
**??????**: `src\Presentation\Dashboard\Pages\Content\Pages\Index.razor`

**??????? ???????? ???????**:
- Title (???????)
- CreatedDate (????? ???????)

**Backend**: ????? ????? ?? `PageService`

---

### 9. Administrators (????????)
**??????**: `src\Presentation\Dashboard\Pages\UserManagement\Administrators\Index.razor`

**??????? ???????? ???????**:
- UserName (??? ????????)
- Email (?????? ??????????)
- Name (????? ??????)
- UserState (??????)

**Backend**: ????? ????? ?? `AdminService` ?? `UserService`

---

## ?? ??? CityService ??????? ?????? ??????

???? ??? ??????? ?????? ???? ????? ??? ????? ?????? ?? `src\Core\BL\Service\Location\CityService.cs`:

```csharp
public PaginatedDataModel<CityDto> GetPage(BaseSearchCriteriaModel criteriaModel)
{
    if (criteriaModel == null)
        throw new ArgumentNullException(nameof(criteriaModel));

    if (criteriaModel.PageNumber < 1)
        throw new ArgumentOutOfRangeException(nameof(criteriaModel.PageNumber), ValidationResources.PageNumberGreaterThanZero);

    if (criteriaModel.PageSize < 1 || criteriaModel.PageSize > 100)
        throw new ArgumentOutOfRangeException(nameof(criteriaModel.PageSize), ValidationResources.PageSizeRange);

    // Base filter for active entities
    Expression<Func<TbCity, bool>> filter = x => !x.IsDeleted;

    // Apply search term if provided
    if (!string.IsNullOrWhiteSpace(criteriaModel.SearchTerm))
    {
        string searchTerm = criteriaModel.SearchTerm.Trim().ToLower();
        filter = x => !x.IsDeleted &&
                     (x.TitleAr != null && x.TitleAr.ToLower().Contains(searchTerm) ||
                     x.TitleEn != null && x.TitleEn.ToLower().Contains(searchTerm));
    }

    // Create ordering function based on SortBy and SortDirection
    Func<IQueryable<TbCity>, IOrderedQueryable<TbCity>> orderBy = null;
    
    if (!string.IsNullOrWhiteSpace(criteriaModel.SortBy))
    {
        var sortBy = criteriaModel.SortBy.ToLower();
        var isDescending = criteriaModel.SortDirection?.ToLower() == "desc";

        orderBy = query =>
        {
            return sortBy switch
            {
                "titlear" => isDescending ? query.OrderByDescending(x => x.TitleAr) : query.OrderBy(x => x.TitleAr),
                "titleen" => isDescending ? query.OrderByDescending(x => x.TitleEn) : query.OrderBy(x => x.TitleEn),
                "title" => isDescending ? query.OrderByDescending(x => x.TitleAr) : query.OrderBy(x => x.TitleAr),
                "createddateutc" => isDescending ? query.OrderByDescending(x => x.CreatedDateUtc) : query.OrderBy(x => x.CreatedDateUtc),
                _ => query.OrderBy(x => x.TitleAr) // Default sorting
            };
        };
    }

    var entitiesList = _baseRepository.GetPage(
        criteriaModel.PageNumber,
        criteriaModel.PageSize,
        filter,
        orderBy);

    var dtoList = _mapper.MapList<TbCity, CityDto>(entitiesList.Items);

    return new PaginatedDataModel<CityDto>(dtoList, entitiesList.TotalRecords);
}
```

---

## ?? ???? ??????????

| ?????? | ????? | ??????? |
|--------|-------|---------|
| ? ????? | 4 | Units, States, ShippingCompanies, Categories |
| ?? ????? ????? ???? | 1 | Cities |
| ? ????? | 4 | Currencies, Orders, Pages, Administrators |
| **???????** | **9** | **???? ????? Index** |

---

## ?? ??????? ???????

### ??????? ????????? ???? ??? ?????:

#### 1. Backend Service:
```csharp
// ????? ??? ????? ??? ??????? GetPage
Func<IQueryable<YourEntity>, IOrderedQueryable<YourEntity>> orderBy = null;

if (!string.IsNullOrWhiteSpace(criteriaModel.SortBy))
{
    var sortBy = criteriaModel.SortBy.ToLower();
    var isDescending = criteriaModel.SortDirection?.ToLower() == "desc";

    orderBy = query =>
    {
        return sortBy switch
        {
            "columnname1" => isDescending ? query.OrderByDescending(x => x.Property1) : query.OrderBy(x => x.Property1),
            "columnname2" => isDescending ? query.OrderByDescending(x => x.Property2) : query.OrderBy(x => x.Property2),
            _ => query.OrderBy(x => x.DefaultProperty)
        };
    };
}

// ??? orderBy ??? GetPage
var result = _repository.GetPage(pageNumber, pageSize, filter, orderBy);
```

#### 2. Frontend Razor:
```razor
@* ??? CSS ?? ????? ????? *@
<style>
    .cursor-pointer {
        cursor: pointer;
        user-select: none;
    }

    .cursor-pointer:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }
</style>

@* ???? ??? ?????? *@
<th class="text-center cursor-pointer" @onclick='() => SortByColumn("ColumnName")'>
    @ResourceLabel
    <i class="@GetSortIconClass("ColumnName") ms-1"></i>
</th>
```

---

## ? ?????????? ????????

??? ???? ?? ????? ??????? ?????:

1. **?????? ??????? ????????**: ???? ??? ??? ?????? ? ???? ?? ??????? A-Z
2. **?????? ??????? ????????**: ???? ??? ???? ? ???? ?? ??????? Z-A
3. **?????? ?????????**: ???? ?? ????? ???????? (? ? ? ? ?)
4. **?????? ???????????**: ???? ?????? ? ???? ?? ???? ???????
5. **?????? ?????**: ???? ?? ??? ? ???? ?? ??? ??????? ?? ????? ?????

---

## ?? ??????? ????????

1. **docs/SORTING_FEATURE_GUIDE.md** - ???? ???? ???????????
2. **docs/SORTING_QUICK_GUIDE_AR.md** - ???? ???? ????????
3. **src/Presentation/Dashboard/Pages/Base/BaseListPage.cs** - ?????? ??????? ???????

---

## ?? ??????? ????

1. **??????? ?????? ????????**: ?????? ?????? `'` ??? attribute ? `"` ?????? ?????
   - ? ????: `@onclick='() => SortByColumn("Title")'`
   - ? ???: `@onclick="() => SortByColumn(\"Title\")"`

2. **????? ???????**: ???? ?? ????? ????? ??????? ??? Frontend ? Backend (case-insensitive)

3. **?????????**: ???? ?? ????? Font Awesome ???? ??????? ???????

4. **??????**: ??? Indexes ??? ??????? ????????? ??????? ?? ????? ????????

---

## ?? ???????

?? ????? ???? ??????? ????? ??? **4 ?????** ?? ??? 9 ????? Index ?? ???????. ??????? ???????? ????:
- ? Units
- ? States  
- ? ShippingCompanies
- ? Categories

??????? ???????? ????? ??? ????? ?????? ??? ??????? ????????.
