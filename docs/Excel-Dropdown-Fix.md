# ?? ????? Excel Data Validation (Dropdowns)

## ???????
??? ??? ??? Excel ???????? ???? ???????:
```
Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.
Removed Feature: Data validation from /xl/worksheets/sheet1.xml part
```

???? ???? ??? ??? ???? ??????? ???????? (dropdowns).

## ?????
Excel ???? Data Validation ?? ??? ???????:
1. ????? ???? ??????? ????? ???? (???? ?? 255 ???)
2. ????? ?? ??? ??????? Named Ranges ???? ????
3. ????? ???? ??????? ??? ?????

## ???? ??????

?? ????? `ExcelTemplateService.cs` ????????:

### 1. ???? ????? ??????? (`_Lists`)
```csharp
IXLWorksheet? listSheet = workbook.Worksheets.FirstOrDefault(w => w.Name == "_Lists");
if (listSheet == null)
{
    listSheet = workbook.Worksheets.Add("_Lists");
    listSheet.Visibility = XLWorksheetVisibility.VeryHidden;
}
```

### 2. Named Ranges ??? ?????
```csharp
var rangeName = "CategoryList";
var rangeAddress = $"_Lists!${GetColumnLetter(listColumn)}$2:${GetColumnLetter(listColumn)}${finalCategories.Count + 1}";

// Delete existing and create new
var existingRange = workbook.NamedRanges.FirstOrDefault(nr => nr.Name == rangeName);
if (existingRange != null)
{
    existingRange.Delete();
}
workbook.NamedRanges.Add(rangeName, rangeAddress);
```

### 3. Fallback ??????? ???????
```csharp
try
{
    range.SetDataValidation().List($"={rangeName}", true);
}
catch
{
    // ??? ??? Named Range? ?????? ????? ?????? (??? 255 ???)
    var categoryList = string.Join(",", finalCategories.Select(c => c.Title).Take(255));
    range.SetDataValidation().List(categoryList, true);
}
```

## ??????? ???????

### ?? GenerateProductTemplate (?? ????????):
? **Categories** - Named Range: `CategoryList`
? **Brands** - Named Range: `BrandList`
? **Units** - Named Range: `UnitList`
? **Boolean Fields** - ????? ??????: `True,False`
? **Attribute Options** - Named Range: `AttrList_{column}`

### ?? GenerateEmptyProductTemplate (???? ??????):
? **Boolean Fields ???** - ????? ??????: `True,False`

## ???????

1. ? **??????? ????**: Named Ranges ??? ???? ????? ?? Excel
2. ? **????? ?????**: ???? ??????? ???? ?? 255 ???
3. ? **????? ????**: ??????? ?? ???? ????? ?????
4. ? **Fallback ???**: ??? ??? Named Range? ?????? ????? ??????

## ????????

### ??? ???????:
```
Excel completed file level validation and repair.
Removed Feature: Data validation from /xl/worksheets/sheet1.xml part
```

### ??? ???????:
- ? ????? ???? ???? ???????
- ? ???? Dropdowns ???? ???? ????
- ? ???? ?????? ????? ?? ??????? ????????
- ? ???? `_Lists` ????? ?????? ?? ????????

## ??????? ???????

1. `src/Presentation/Dashboard/Services/ExcelTemplateService.cs`
   - `AddCategoryDropdown()` - ?????
   - `AddBrandDropdown()` - ?????
   - `AddUnitDropdown()` - ?????
   - `AddAttributeOptionsDropdown()` - ?????
   - `GetColumnLetter()` - helper method

## ???????

- ??????? Boolean (True/False) ?????? ????? ?????? ????? ????? ????
- Named Ranges ??? ?? ???? ????? ?? ??? workbook
- ??? ??? Named Range ?????? ??? ????? ???? ???? ????? ???????
- ???? `_Lists` ????? ?????? (`VeryHidden`) ??? ???? ??????? ?? ????? Excel

## ????????

1. ? ?????? Named Ranges ?????? ??????? ???????
2. ? ???? ??????? ?? ???? ????? ??????
3. ? ?????? `VeryHidden` ????? ?? `Hidden` ?????? ????
4. ? ?????? ??? Fallback ??????? ???????
5. ? ????? ????? ?? Excel ?????? ??? ???????

## ???????

??????? **?? ???? ???????** ?
- ??? dropdowns ???? ???? ?????
- ?? ???? ??????? ?? Excel
- ????? ????? ??????
