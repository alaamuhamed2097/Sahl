# ???? ????????? - Excel Import Enhancement

## ? ????????? ???????? ???? ?? ???????:

### 1. **Dropdown Lists ?? Excel** ??

?? ????? Dropdown Lists ????? ?????? ????????:

#### ?. Category Dropdown
```csharp
private void AddCategoryDropdown(IXLWorksheet sheet, int column, List<CategoryDto> categories)
{
    var finalCategories = categories.Where(c => c.IsFinal).ToList();
    var categoryList = string.join(",", finalCategories.Select(c => $"{c.Title}"));
    var range = sheet.Range(2, column, 10000, column);
    range.SetDataValidation().List(categoryList, true);
}
```

#### ?. Brand & Unit Dropdowns
```csharp
private void AddBrandDropdown(IXLWorksheet sheet, int column, Dictionary<Guid, string> brands)
{
    var brandList = string.Join(",", brands.Values);
    var range = sheet.Range(2, column, 10000, column);
    range.SetDataValidation().List(brandList, true);
}
```

#### ?. Boolean Fields Dropdown (True/False)
```csharp
private void AddBooleanDropdown(IXLWorksheet sheet, int column)
{
    var range = sheet.Range(2, column, 10000, column);
    range.SetDataValidation().List("True,False", true);
}
```

? **????? ???**: StockStatus, IsNewArrival, IsBestSeller, IsRecommended

#### ?. Attribute Options Dropdown
```csharp
private void AddAttributeOptionsDropdown(IXLWorksheet sheet, int column, List<AttributeOptionDto> options)
{
    var optionList = string.Join(",", options.Select(o => o.Title));
    var range = sheet.Range(2, column, 10000, column);
    range.SetDataValidation().List(optionList, true);
}
```

### 2. **Auto-Fit Columns** ??

?? ????? Auto-fit ????? ???????:

```csharp
// ?? ????? ?? sheet
sheet.Columns().AdjustToContents();

// ??????? ???????
sheet.Column(1).Width = 100;
```

? **???? ???**:
- Products sheet
- Categories sheet  
- Brands sheet
- Units sheet
- AttributeOptions sheet
- Instructions sheet

### 3. **Names Instead of IDs** ??

#### ?. ?? Template Generation:
```csharp
// ???????? ???????? ????: ID + Name
sheet.Cell(row, 1).Value = category.Id.ToString();
sheet.Cell(row, 2).Value = category.TitleAr;
sheet.Cell(row, 3).Value = category.TitleEn;

// Dropdown ???? ??????? ???
var categoryList = string.Join(",", finalCategories.Select(c => $"{c.Title}"));
```

#### ?. ?? Parsing:
???? ???? ?? ??????? ???? IDs:

```csharp
private Guid ParseCategoryValue(string? value, List<CategoryDto> categories)
{
    // Try parse as GUID first
    if (Guid.TryParse(value, out var guid))
        return guid;

    // Try match by name
    var category = categories.FirstOrDefault(c => 
        c.Title.Equals(value.Trim(), StringComparison.OrdinalIgnoreCase));
    
    return category?.Id ?? Guid.Empty;
}
```

? **????? ???**:
- Categories
- Brands
- Units
- Attribute Options

## ?? ?? ?? ??? (????? ????? Resources):

### Resources ????????:

??? ????? ??? ??? Resources ??? ??????? ???????:
- `ECommerceResources.resx` (English)
- `ECommerceResources.ar.resx` (Arabic)
- `GeneralResources.resx` (English)
- `GeneralResources.ar.resx` (Arabic)
- `FormResources.resx` (English)
- `FormResources.ar.resx` (Arabic)
- `BrandResources.resx` (English)
- `BrandResources.ar.resx` (Arabic)

???? ??????? ??????? ??????? ???????:
- `docs/Required-Resources-Excel-Import.md`
- `docs/Import-Page-Resources.md`

## ?? ????? ???????:

### 1. ????? Resources (?????):

???? ?? ??? resources ???? ????? ????????:

**???? ?? `ECommerceResources.resx`:**
```xml
<data name="Options" xml:space="preserve">
    <value>Options</value>
</data>
<data name="PricingAttribute" xml:space="preserve">
    <value>Pricing Attribute</value>
</data>
```

**???? ????? ?? ?????? ??????? `ECommerceResources.ar.resx`:**
```xml
<data name="Options" xml:space="preserve">
    <value>??????</value>
</data>
<data name="PricingAttribute" xml:space="preserve">
    <value>????? ???????</value>
</data>
```

### 2. Build Solution:
```bash
dotnet build
```

### 3. ??????:
1. ????? ??? `/products/import`
2. ???? category
3. ???? template
4. ???? ??? Excel:
   - ? ???? Dropdown lists ?? ???????
   - ? ??????? ???? ????? (Auto-fit)
   - ? ????? ?????? ??????? ??? ??? IDs
5. ???? ???????? ????? Upload

## ?? ???????:

### User Experience:
- ? **??? ?????????**: Dropdown ??? ????? IDs
- ? **????**: ??????? ???? ?????
- ? **???**: ?? ???? ????? ??? ?????
- ? **???**: ???? Names ? IDs

### Technical:
- ? **Validation ???**: ???? ????? ???????
- ? **Backward Compatible**: ???? ?? IDs ???????
- ? **Multilingual Ready**: Resources ??????? ??????????
- ? **Maintainable**: ??? ???? ?????

## ?? ???? ??? ??? Excel:

### Before:
```
| CategoryId                              |
|-----------------------------------------|
| 550e8400-e29b-41d4-a716-446655440000   | ? ???
```

### After:
```
| Category     ?  |
|------------------|
| Electronics  ?  | ? ???!
```

## ?? Next Steps:

1. **??? Resources** ??? ?? ???? ?? ??????? ???????
2. **Build** ???????
3. **Test** ??? import workflow
4. **Verify** ?? Dropdowns ????
5. **Enjoy** ??????? ????????! ??

## ?? ?? ???? ???? ?????:

???? ??:
- ? ?? ????? ???? Resources
- ? ?? Build ?????
- ? ?? ???? Compilation Errors
- ? ????? `.xlsx` format (??? `.xls`)

????? ???? 100% - ??? ????? Resources! ??
