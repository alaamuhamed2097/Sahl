# ????? ??????? ??? ????? Index ??????

## ??????? ??????? ?????? ???????

### 1. ?? ??????? ??????? (Backend Service)

```csharp
public PaginatedDataModel<YourDto> GetPage(BaseSearchCriteriaModel criteriaModel)
{
    // ... ????? ??????? ...
    
    // ????? ???? ???????
    Func<IQueryable<YourEntity>, IOrderedQueryable<YourEntity>> orderBy = null;
    
    if (!string.IsNullOrWhiteSpace(criteriaModel.SortBy))
    {
        var sortBy = criteriaModel.SortBy.ToLower();
        var isDescending = criteriaModel.SortDirection?.ToLower() == "desc";

        orderBy = query =>
        {
            return sortBy switch
            {
                "title" => isDescending ? query.OrderByDescending(x => x.TitleAr) : query.OrderBy(x => x.TitleAr),
                "createddateutc" => isDescending ? query.OrderByDescending(x => x.CreatedDateUtc) : query.OrderBy(x => x.CreatedDateUtc),
                _ => query.OrderBy(x => x.TitleAr) // ??????? ?????????
            };
        };
    }

    var result = _repository.GetPage(pageNumber, pageSize, filter, orderBy);
    // ...
}
```

### 2. ?? ????? ???????? (Razor Component)

??? CSS ?? ????? ?????:

```razor
<style>
    .cursor-pointer {
        cursor: pointer;
        user-select: none;
    }

    .cursor-pointer:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }
</style>
```

???? ??? ?????? ????? ???? ?????:

```razor
<thead class="bg-light">
    <tr>
        <!-- ???? ???? ??????? -->
        <th class="text-center align-middle cursor-pointer" @onclick='() => SortByColumn("Title")'>
            @ECommerceResources.Title
            <i class="@GetSortIconClass("Title") ms-1"></i>
        </th>
        
        <!-- ???? ??? ???? ??????? -->
        <th class="text-center align-middle cursor-pointer" @onclick='() => SortByColumn("CreatedDateUtc")'>
            @FormResources.CreationDate
            <i class="@GetSortIconClass("CreatedDateUtc") ms-1"></i>
        </th>
        
        <!-- ???? ??? ???? ??????? -->
        <th class="text-center align-middle">@ECommerceResources.Actions</th>
    </tr>
</thead>
```

## ???? ???? - ???? ????? (Cities)

### Backend Service:

```csharp
public PaginatedDataModel<CityDto> GetPage(BaseSearchCriteriaModel criteriaModel)
{
    // ... validation code ...
    
    Expression<Func<TbCity, bool>> filter = x => x.CurrentState == 1;
    
    if (!string.IsNullOrWhiteSpace(criteriaModel.SearchTerm))
    {
        string searchTerm = criteriaModel.SearchTerm.Trim().ToLower();
        filter = x => x.TitleAr.ToLower().Contains(searchTerm) || 
                     x.TitleEn.ToLower().Contains(searchTerm);
    }

    Func<IQueryable<TbCity>, IOrderedQueryable<TbCity>> orderBy = null;
    
    if (!string.IsNullOrWhiteSpace(criteriaModel.SortBy))
    {
        var sortBy = criteriaModel.SortBy.ToLower();
        var isDescending = criteriaModel.SortDirection?.ToLower() == "desc";

        orderBy = query =>
        {
            return sortBy switch
            {
                "title" => isDescending ? query.OrderByDescending(x => x.TitleAr) : query.OrderBy(x => x.TitleAr),
                "statename" => isDescending ? query.OrderByDescending(x => x.State.TitleAr) : query.OrderBy(x => x.State.TitleAr),
                "createddateutc" => isDescending ? query.OrderByDescending(x => x.CreatedDateUtc) : query.OrderBy(x => x.CreatedDateUtc),
                _ => query.OrderBy(x => x.TitleAr)
            };
        };
    }

    var result = _repository.GetPage(
        criteriaModel.PageNumber,
        criteriaModel.PageSize,
        filter,
        orderBy);

    return new PaginatedDataModel<CityDto>(result.Items, result.TotalRecords);
}
```

### Frontend Razor:

```razor
<table class="table table-hover mb-0">
    <thead class="bg-light">
        <tr>
            <th class="text-center align-middle cursor-pointer" @onclick='() => SortByColumn("Title")'>
                @ECommerceResources.Title
                <i class="@GetSortIconClass("Title") ms-1"></i>
            </th>
            <th class="text-center align-middle cursor-pointer" @onclick='() => SortByColumn("StateName")'>
                @ECommerceResources.State
                <i class="@GetSortIconClass("StateName") ms-1"></i>
            </th>
            <th class="text-center align-middle" style="width: 200px;">@ECommerceResources.Actions</th>
        </tr>
    </thead>
    <tbody>
        @if (items != null && items.Any())
        {
            @foreach (var item in items)
            {
                <tr>
                    <td class="text-center">@item.Title</td>
                    <td class="text-center">@item.StateName</td>
                    <td class="text-center">
                        <button class="btn btn-primary btn-sm" @onclick="() => Edit(item)">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" @onclick="() => Delete(item.Id)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            }
        }
    </tbody>
</table>
```

## ??????? ????

1. **????? ???????**: ?????? ????? ????? ??????? ??? Frontend ? Backend
2. **?????? ????????**: ?????? ?????? ?????? ????? `'` ??? `@onclick` ??????? ?????? ?????? `"` ??????
3. **?????????**: 
   - `fa-sort` ? ??? ???? (?????)
   - `fa-sort-up` ? ????? ?????? (????)
   - `fa-sort-down` ? ????? ?????? (????)
4. **???????**: ???? ?? ?????? ??? ?? `BaseListPage<YourDto>`

## ????? ??????? ???? ????? ????? ???????

- [x] Units (????? ??????) ?
- [ ] Categories (?????????)
- [ ] States (?????????)
- [ ] Cities (?????)
- [ ] ShippingCompanies (????? ?????)
- [ ] Currencies (???????)
- [ ] Orders (???????)
- [ ] Pages (??????? ???????)
- [ ] Administrators (????????)

## ??????? ???????

### ??????? ?? ????
- ???? ?? ????? ????? ??????? ??? Frontend ? Backend
- ???? ?? ?? ??? Service ???? `orderBy` ??? ??? Repository
- ???? ??? Network tab ?? ??????? ?????? ?? ????? `SortBy` ? `SortDirection`

### ????????? ?? ????
- ???? ?? ????? Font Awesome
- ???? ?? ????????: `fas fa-sort`, `fa-sort-up`, `fa-sort-down`
- ???? ?? ??????? `GetSortIconClass()` ???? ????

### ????? Compilation
- ?????? ?????? ?????? ????? `'` ??? `@onclick` attribute
- ?????? ?????? ?????? ?????? `"` ???? ??? lambda expression
- ???? ????: `@onclick='() => SortByColumn("Title")'`

## ???????

??????? ???? ???? ?? ???? Units. ??????? ??? ????? ????:
1. ??? ???? ??????? ?? ??? Service (Backend)
2. ???? ???? ?????? ????? ????? ????? (Frontend)
3. ??? CSS ??? hover effect
4. ????? ??????? ???????? ?????????
