# Excel Product Import System

## ???? ????
???? ??????? ???????? ?? Excel ???? ?????????? ?????? ?????? ?????? ???? ????? ??? ??? Excel. ?????? ????:

- ?? Categories ?? Attributes ?????????
- ?? Pricing Combinations ?????????
- ?? ????? Attributes ???? ???? ??? ?????
- ? Validation ????? ????????
- ?? ????? Template ???? ??? Category

## ????? ?????????

### 1. ???????? ??? ???? Import
?? ????? Products? ???? ??? ?? "Import" ??

### 2. ?????? Category
- ???? ??? Category ???? ???? ????? ?????? ??
- ?? ??? Final Categories ???? ????????

### 3. ????? Excel Template
- ??? ?????? Category? ???? "Download Excel Template"
- ???? ????? ??? Excel ???? ????? ???:
  - ????? ?????? ????????
  - ????? Attributes ?????? ???? Category
  - ????? Pricing Attributes
  - ????? ?????? (Categories, Brands, Units, AttributeOptions)
  - ???? ??????? Instructions

### 4. ??? ???????? ?? Excel

#### ??????? ???????? (Required *)
```
- TitleAr*: ??? ?????? ????????
- TitleEn*: ??? ?????? ???????????
- ShortDescriptionAr*: ??? ????? ????????
- ShortDescriptionEn*: ??? ????? ???????????
- DescriptionAr*: ??? ???? ????????
- DescriptionEn*: ??? ???? ???????????
- CategoryId*: ???? ??? Category (?? ???? Categories)
- BrandId*: ???? ??? Brand (?? ???? Brands)
- UnitId*: ???? ??? Unit (?? ???? Units)
- Price*: ????? (??? ????)
- Quantity*: ?????? (??? ????)
- StockStatus*: ???? ??????? (True/False)
```

#### ??????? ??????????
```
- IsNewArrival: ???? ???? (True/False)
- IsBestSeller: ?????? ?????? (True/False)
- IsRecommended: ???? ???? ?? (True/False)
- ThumbnailImagePath: ???? ?????? ????????
- ImagePath1-5: ?????? ??? ??????
```

#### ????? Attributes
```
- Attr_{AttributeId}_{AttributeName}: ???? ????? ??? Attribute
- PricingAttr_{AttributeId}_{AttributeName}*: ??? ?????? ?????? ??????
```

### 5. Pricing Attributes ????

??? ??? ?????? ?? Color ? Size ?? Pricing Attributes:

```excel
PricingAttr_abc123_Color    | PricingAttr_def456_Size
---------------------------------------------------
red-id,blue-id,green-id     | s-id,m-id,l-id
```

???? ????? **9 combinations** ????????:
- Red + S
- Red + M
- Red + L
- Blue + S
- Blue + M
- Blue + L
- Green + S
- Green + M
- Green + L

### 6. ??? ?????
- ??? ??? ????????? ???? ????? ?? `.xlsx`
- ???? ????? ?? ???? Import

### 7. ?????? ????????
- ???? ??? ???? ????????? ?????????
- ????? ?????? ???????? ???? ?? ?????? ??? ??????
- ???? ??? ??? ??? Combinations ??? ????

### 8. ?????????
- ???? "Import X Products"
- ???? ??????? ???????? ????????
- ???? ??? ????? ???????? (???/???)

## ?????? ???????

### ??????? ????????
```
src/Presentation/Dashboard/
??? Services/
?   ??? ExcelTemplateService.cs    # ????? ??????? Excel
??? Pages/Catalog/Products/
?   ??? Import.razor                # ????? ?????????
?   ??? Index.razor                 # ?? Import ?? ????? ????????
??? Extensions/
    ??? DomainServiceExtensions.cs  # ????? Service
```

### ExcelTemplateService

#### GenerateProductTemplate()
???? Excel Template ????? ???:
1. **Products Sheet**: ?????? ???????? ?????? ????????
2. **Categories Sheet**: ????? Categories ???????
3. **Brands Sheet**: ????? Brands ???????
4. **Units Sheet**: ????? Units ???????
5. **AttributeOptions Sheet**: ??? Attributes ???????
6. **Instructions Sheet**: ??????? ?????????

#### ParseProductsFromExcel()
???? ??? Excel ???????:
- ?????? ?????? ????????
- ??? Attributes ???????
- ??? Pricing Attributes (?????? ??????)
- ?????? ?????

### Import.razor
???? ????? ????????? ??? 4 ?????:
1. **SelectCategory**: ?????? Category
2. **UploadFile**: ??? Excel
3. **ReviewData**: ?????? ????????
4. **Complete**: ??? ???????

### ?????? Pricing Combinations
```csharp
// ????? Cartesian Product ??? Pricing Attributes
private List<List<Guid>> GeneratePricingCombinations(
    Dictionary<Guid, List<Guid>> attributeValues)
{
    // ??? ??? Color=[Red,Blue] ? Size=[S,M]
    // ???????: [[Red,S], [Red,M], [Blue,S], [Blue,M]]
}
```

## Validation

### ??? ????? Excel
- ?????? ?? ???? ???? ??????? ????????
- ?????? ?? ??? ???????? (Guid, decimal, int, bool)
- ?????? ?? Attribute Options ??????

### ??? ????? Application
- ?????? ?? Category ?????
- ?????? ?? Brand ?????
- ?????? ?? Unit ?????
- ?????? ?? Attribute Options ?????

### ???? ?????????
- ?????? ?? ??? ????? 1000 ???? ?? ??? ????
- ?????? ?? ??? ????? (??? ?? 10MB)
- ?????? ?? ?????? ????? (.xlsx ???)

## ?????

### ???? 1: ???? ???? ???? Pricing Attributes
```excel
TitleEn         | Price | Quantity | CategoryId | BrandId | UnitId
----------------------------------------------------------------
Blue T-Shirt    | 25.00 | 100      | cat-guid   | brand-guid | unit-guid
```

### ???? 2: ???? ?? Pricing Attributes
```excel
TitleEn  | Price | PricingAttr_Color    | PricingAttr_Size
--------------------------------------------------------
T-Shirt  | 25.00 | red-id,blue-id       | s-id,m-id,l-id
```
???? ????? 6 combinations (2 colors × 3 sizes)

### ???? 3: ???? ?? Attributes ?????
```excel
TitleEn     | Price | Attr_Material | Attr_Origin
------------------------------------------------
T-Shirt     | 25.00 | Cotton        | Egypt
```

## ??????? ????

?? **???????**
- ???? ???? ???????? Example ??? ?????????
- ???? ?? ??????? IDs ??????? ?? ??????? ????????
- ??? Price ?? Products Sheet ?? ????? ????????? ??? Combinations
- ??? ????? ????? ??? Combinations ??? ????????? ??? ??????

? **?????**
- ?????? Copy-Paste ??? IDs ?? ??????? ????????
- ???? ???? Instructions ?? ?????
- ???? ???? ???? ?? ???????? ???????
- ?????? Find & Replace ?? Excel ?????? ????? ?????

## ??????? ???????

### "Invalid GUID"
- ???? ?? ??? ??? ID ?????? ?? ??????? ????????
- ?? ???? ?????? ?????

### "Combination count is 0"
- ???? ?? ????? Option IDs ?? ????? PricingAttr
- ???? ??? IDs ?????? ???? ??????

### "Failed to parse row X"
- ???? ???????? ?? ???? X
- ???? ?? ??? ???????? ???? (????? ?? ??????? ???????)

## ?????
???????? ?? ??????? ?? ?????? ???? ????? ???????.
