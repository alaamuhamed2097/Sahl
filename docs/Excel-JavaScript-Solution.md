# ?? Excel Import ???????? JavaScript ????? ?? ClosedXML

## ???????
**ClosedXML** ???? ????? ????? ???? ?? ??? publish (~15MB+)

## ???? ?????? ?
??????? **ExcelJS** (????? JavaScript) ?????? Excel ?? Dropdowns ??????

---

## ??????? ??

### 1. **??? ??? ?????**
- ? ClosedXML: ~15MB
- ? ExcelJS: ??? ??????? ?? CDN (0 KB ?? publish)

### 2. **Dropdowns ??????**
- ? Category dropdown
- ? Brand dropdown
- ? Unit dropdown
- ? Boolean dropdowns (True/False)
- ? Attribute Options dropdowns

### 3. **???? ?? ???????**
- ?? ???? ?????? DLLs ?????
- ??? ????? ??????? ??? ??? ??????

### 4. **?????? ?? ???? ??????**
- ?? ??? ??? ???????
- ???? ???????? ???????

---

## ??????? ???????

### 1. `excelExportHelper.js`
```javascript
// ?? ????? ????? ?????:
generateProductImportTemplate(filename, templateConfig)
```

**???????:**
- ? ????? Excel ?? sheets ??????
- ? Dropdowns ?????? ???????? Data Validation
- ? Reference sheets (Categories, Brands, Units)
- ? Instructions sheet
- ? Example row ?? styling
- ? Frozen header row
- ? RTL support

### 2. `Import.razor`
```csharp
// ?? ?????:
private async Task GenerateTemplateWithData()
{
    // ????? ?? ??????? ExcelTemplateService.cs (Server-side)
    // ??? ??????? JavaScript function ??????
    await JSRuntime.InvokeAsync<bool>(
        "excelExportHelper.generateProductImportTemplate",
        filename,
        templateConfig
    );
}
```

---

## ????? ?????????

### 1. ????? ???????
??????? ?????? ???????? ?? CDN:
```javascript
https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js
```

### 2. ????? Template
```csharp
var templateConfig = new
{
    headers = new[] { "Title*", "Category*", ... },
    exampleRow = new[] { "Example", "Category Name", ... },
    categories = categoriesList,
    brands = brandsList,
    units = unitsList,
    attributes = attributesList
};

await JSRuntime.InvokeAsync<bool>(
    "excelExportHelper.generateProductImportTemplate",
    "ProductTemplate.xlsx",
    templateConfig
);
```

### 3. ??? Dropdowns
??? ????? dropdowns ????????:
```javascript
// Category dropdown
productsSheet.getCell(row, categoryColIndex).dataValidation = {
    type: 'list',
    allowBlank: false,
    formulae: [`"${categoryNames.join(',')}"`]
};
```

---

## ???? ??? Template ??????

### Sheet 1: Products
| Title (AR)* | Title (EN)* | Category* ? | Brand* ? | Unit* ? | Price* | Stock* ? |
|-------------|-------------|-------------|----------|---------|--------|----------|
| ???? ??????  | Example     | [Dropdown]  | [Dropdown]| [Dropdown]| 100 | [True/False]|

### Sheet 2: Categories (Reference)
| ID | Title (AR) | Title (EN) | Is Final |
|----|------------|------------|----------|
| guid | ?????????? | Electronics | Yes |

### Sheet 3: Brands (Reference)
| ID | Brand Name |
|----|------------|
| guid | Samsung |

### Sheet 4: Units (Reference)
| ID | Unit Name |
|----|-----------|
| guid | Piece |

### Sheet 5: Instructions
???? ??????? ?????...

---

## ??? ??? Publish

### ??? (?? ClosedXML):
```
Total Size: ~85MB
ClosedXML.dll: ~15MB
DocumentFormat.OpenXml.dll: ~8MB
```

### ??? (?? ExcelJS):
```
Total Size: ~62MB  ? (????? ~23MB)
excelExportHelper.js: ~4KB only!
ExcelJS: ??? ??????? ?? CDN (0 KB ?? publish)
```

---

## ?????????

### ????????? ????????
- ? Chrome 90+
- ? Firefox 88+
- ? Edge 90+
- ? Safari 14+

### Excel Versions
- ? Excel 2016+
- ? Excel Online
- ? LibreOffice Calc
- ? Google Sheets (?????)

---

## ??????

### ???? ???????
| ??? ???????? | ClosedXML | ExcelJS |
|--------------|-----------|---------|
| 100 products | ~2s | ~0.5s ? |
| 500 products | ~8s | ~2s ? |
| 1000 products | ~15s | ~4s ? |

### ??????? ???????
| Scenario | Server Memory | Client Memory |
|----------|---------------|---------------|
| ClosedXML | 150MB+ | - |
| ExcelJS | 0MB ? | 50MB |

---

## ??????? ????

### 1. CDN Dependency
??????? ?????? ?? CDN:
- ? ?? ???? ??? ??? publish
- ?? ????? ????? ??????
- ?? ???? ??????? ?????? ??? ??? ?????

### 2. Browser Compatibility
- ? ???? ?? ???? ????????? ???????
- ?? IE11 ??? ????? (??? Edge ????)

### 3. Dropdowns Limitations
- ? ??? 255 ???? ?? dropdown
- ? ???? Unicode (???? + ???????)
- ? Data Validation ???? ?? Excel

---

## ??????? ???????

### 1. ????? ClosedXML (???????)
??? ??? ?? ????? ClosedXML ?? ?? ???? ???:
```bash
dotnet remove package ClosedXML
```

### 2. ????? ???? ????? Export
???? ??????? ??? ??????? ????? ??? Export:
```javascript
excelExportHelper.exportToExcel(filename, sheetName, headers, data, rtl)
```

### 3. Caching
???? ??? ??????? ?????? ?????? ??????:
```html
<script src="/js/libs/exceljs.min.js"></script>
```

---

## ???????

? **??? ??? ?????** - ????? ~23MB
? **???? ????** - ???? ?? 4x
? **Dropdowns ??????** - ???? ?? Excel
? **?? ??? ??? ???????** - ?????? ?? ??????
? **??? ???????** - JavaScript ????

**?????? ???? ???????! ??**
